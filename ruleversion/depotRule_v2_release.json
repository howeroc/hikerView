{
    "title": "总仓库",
    "author": "Reborn",
    "version": 27,
    "updateText": "1.‘‘优化’’:规则映射功能支持正则批量匹配映射，云端模板请看开发文档\n2.‘‘新功能’’:支持规则映射功能(即替换规则名跟仓库规则对比)\n3.更多更新日志请点击访问源网页查看",
    "rule": "rule://5rW36ZiU6KeG55WM6KeE5YiZ5YiG5Lqr77yM5b2T5YmN5YiG5Lqr55qE5piv77ya6aaW6aG16aKR6YGT77yMUmVib3Ju77+laG9tZV9ydWxl77+leyJmaXJzdEhlYWRlciI6ImNsYXNzIiwidGl0bGUiOiLmgLvku5PlupMiLCJhdXRob3IiOiJSZWJvcm4iLCJ1cmwiOiJoaWtlcjovL2hvbWUiLCJ2ZXJzaW9uIjoyNywiY29sX3R5cGUiOiJpY29uXzIiLCJjbGFzc19uYW1lIjoiIiwiY2xhc3NfdXJsIjoiIiwiYXJlYV9uYW1lIjoiIiwiYXJlYV91cmwiOiIiLCJ5ZWFyX25hbWUiOiIiLCJ5ZWFyX3VybCI6IiIsImZpbmRfcnVsZSI6ImpzOlxudmFyIHJlcyA9IHt9O1xudmFyIGQgPSBbXTtcbnZhciBtUnVsZSA9IEpTT04ucGFyc2UoZ2V0UnVsZSgpKTtcblxuLy8g5Zyo6L+Z6YeM5re75Yqg5LuT5bqT6YWN572u77yM5Y+v5L2/5pys5Zyw5re75Yqg55qE5LuT5bqT572u6aG2XG52YXIgYXV0aG9yTGlzdCA9IFtcbiAgICBcIlvkvovlrZBd572u6aG256eB5Lq65LuT5bqTQEBSZWJvcm5fMEBASGlrZXJSdWxlc1ByaXZhY3lAQGFjY2Vzc190b2tlbj0nKioqKidcIixcbiAgICBcIlvkvovlrZBd6Ieq5a6a5LmJ5paH5Lu25ZCNQEBSZWJvcm5fMEBASGlrZXJSdWxlc0RlcG90QEByZW1vdGVGaWxlbmFtZT0ndXBkYXRlXzEuanNvbidcIixcbiAgICAgXCJb5L6L5a2QXemdnueggeS6keS7k+W6k+inhOWImUBAYXBpVHlwZT0nMCdAQGZ1bGxVcmw9J2h0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9yYXcvbWFzdGVyL3J1bGV2ZXJzaW9uL1JlYm9ybi91cGRhdGUuanNvbidcIlxuXTtcbnZhciByZW1vdGVBdXRob3JMaXN0VXJsID0gXCJodHRwczovL2dpdGVlLmNvbS9xaXVzdW5zaGluZTIzMy9oaWtlclZpZXcvcmF3L21hc3Rlci9ydWxldmVyc2lvbi9hdXRob3JMaXN0Lmpzb25cIjtcbnZhciByZW1vdGVBdXRob3JMaXN0ID0gW107XG50cnkge1xuICAgIGV2YWwoXCJyZW1vdGVBdXRob3JMaXN0PVwiICsgZmV0Y2gocmVtb3RlQXV0aG9yTGlzdFVybCwge30pKTtcbn0gY2F0Y2ggKGUpIHtcbn1cbkFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGF1dGhvckxpc3QsIHJlbW90ZUF1dGhvckxpc3QpO1xuLy8g5Zyo6L+Z6YeM5re75Yqg5LuT5bqT6YWN572u77yM5Y+v5L2/5pys5Zyw5re75Yqg55qE5LuT5bqT572u5bqVXG52YXIgYXV0aG9yTGlzdEJvdHRvbSA9IFtcbiAgICBcIlvkvovlrZBd572u5bqV5pys5Zyw5LuT5bqTQEBSZWJvcm5fMEBASGlrZXJSdWxlc1ByaXZhY3lcIlxuXTtcbmlmIChhdXRob3JMaXN0Qm90dG9tLmxlbmd0aCAhPSAwKSBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShhdXRob3JMaXN0LCBhdXRob3JMaXN0Qm90dG9tKTtcblxuLy8g5Zyo6L+Z6YeM5re75Yqg6ZqP5py65aS05YOPXG52YXIgcGljVXJsTGlzdCA9IFtcbiAgICBcImh0dHBzOi8vd3d3LmVhc3lpY29uLm5ldC9hcGkvcmVzaXplQXBpLnBocD9pZD0xMjcxNjI0JnNpemU9MTI4XCIsXG4gICAgXCJodHRwczovL3d3dy5lYXN5aWNvbi5uZXQvYXBpL3Jlc2l6ZUFwaS5waHA/aWQ9MTI3MTY0NyZzaXplPTEyOFwiLFxuICAgIFwiaHR0cHM6Ly93d3cuZWFzeWljb24ubmV0L2FwaS9yZXNpemVBcGkucGhwP2lkPTEyNjY1MzYmc2l6ZT0xMjhcIixcbiAgICBcImh0dHBzOi8vd3d3LmVhc3lpY29uLm5ldC9hcGkvcmVzaXplQXBpLnBocD9pZD0xMjcxNjU1JnNpemU9MTI4XCIsXG5dO1xuXG4vLyDpmpDol4/lvIDlhbPvvIzkuI3pnIDopoHpmpDol4/or7forr7nva7kuLpmYWxzZVxudmFyIG5lZWRIaWRlUnVsZSA9IHRydWU7XG4vLyDoh6rooYzmt7vliqDopoHpmpDol4/nmoTmoIforrDvvIzmoLzlvI/kuLrvvJpb5qCH6K6w5ZCNXVxudmFyIGhpZGVTeW1ib2xzID0gW1wiW+aooeadv11cIiwgXCJb5pyq5a6M5oiQXVwiXTtcblxuLy8g5oC75LuT5bqT5pu05paw5Zyw5Z2AXG52YXIgcmVtb3RlRGVwb3RSdWxlVXJsID0gXCJodHRwczovL2dpdGVlLmNvbS9xaXVzdW5zaGluZTIzMy9oaWtlclZpZXcvcmF3L21hc3Rlci9ydWxldmVyc2lvbi9kZXBvdFJ1bGVfdjJfcmVsZWFzZS5qc29uXCI7XG4vLyDku5PlupPnirbmgIHnvJPlrZjmlofku7blnLDlnYBcbnZhciBzdGF0dXNDYWNoZUZpbGUgPSBcImhpa2VyOi8vZmlsZXMvXCIgKyBtUnVsZS50aXRsZSArIFwiX1wiICsgbVJ1bGUuYXV0aG9yICsgXCIuanNvblwiO1xuLy8g5Li+5L6LIGhpa2VyOi8vZmlsZXMvZGVwb3RTdGF0dXNfdjIuanNvblxucHV0VmFyKHtrZXk6ICdzdGF0dXNDYWNoZUZpbGUnLCB2YWx1ZTogc3RhdHVzQ2FjaGVGaWxlfSk7XG5cbi8vIOaKiuaAu+S7k+W6k+eKtuaAgeWGmeWFpeaWh+S7tlxuZnVuY3Rpb24gd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cykge1xuICAgIHdyaXRlRmlsZShzdGF0dXNDYWNoZUZpbGUsIEpTT04uc3RyaW5naWZ5KGRlcG90U3RhdHVzKSk7XG59XG5cbi8vIOiLpeS4jeaYr+esrOS4gOasoeS9v+eUqOaAu+S7k+W6k+WImemakOiXj+W8gOWPkeaWh+aho1xudmFyIGRlcG90U3RhdHVzID0ge307XG52YXIgZGVwb3RTdGF0dXNGaWxlID0gZmV0Y2goc3RhdHVzQ2FjaGVGaWxlLCB7fSk7XG5pZiAoZGVwb3RTdGF0dXNGaWxlICE9IFwiXCIpIHtcbiAgICBldmFsKFwiZGVwb3RTdGF0dXM9XCIgKyBkZXBvdFN0YXR1c0ZpbGUpO1xufVxuLy8g6Iul6ZyA6KaB5rC45LmF5pi+56S65byA5Y+R5paH5qGj77yM5YiZ5Y+W5raI5rOo6YeKXG4vLyBkZXBvdFN0YXR1cy5zaG93RGV2RG9jID0gdHJ1ZTtcbi8vIOiLpemcgOimgeawuOS5heaYvuekuuaPkOekuu+8jOWImeWPlua2iOazqOmHilxuLy8gZGVwb3RTdGF0dXMuc2hvd1RpcHMgPSB0cnVlO1xuLy8g6Iul6ZyA6KaB5rC45LmF5pi+56S65L6L5a2Q77yM5YiZ5Y+W5raI5rOo6YeKXG4vLyBkZXBvdFN0YXR1cy5zaG93RXRjID0gdHJ1ZTtcblxuXG5mdW5jdGlvbiBpc0hpZGVSdWxlKHJ1bGVUaXRsZSkge1xuICAgIGlmIChuZWVkSGlkZVJ1bGUgIT0gdHJ1ZSkgcmV0dXJuIGZhbHNlO1xuICAgIC8vIGlmIChoaWRlU3ltYm9scy5sZW5ndGggPT0gMCkgcmV0dXJuIGZhbHNlO1xuICAgIHZhciBydWxlVGVtcCA9IHJ1bGVUaXRsZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhpZGVTeW1ib2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChydWxlVGVtcC5pbmRleE9mKGhpZGVTeW1ib2xzW2ldKSAhPSAtMSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZC5wdXNoKHtcbiAgICB0aXRsZTogXCLmrKLov47mnaXliLDop4bnlYzmgLvku5PlupNcIixcbiAgICBkZXNjOiBcIuWcqOi/memHjO+8jOS9oOWPr+S7peeVhea4uOWQhOS4quWkp+S9rOeahOinhOWIme+8jOW/q+mAn+a1j+iniOW/q+mAn+WvvOWFpVwiLFxuICAgIGNvbF90eXBlOiBcInRleHRfY2VudGVyXzFcIlxufSk7XG5cbmlmIChkZXBvdFN0YXR1cy5zaG93VGlwcyAhPSBmYWxzZSkge1xuICAgIGQucHVzaCh7XG4gICAgICAgIHRpdGxlOiBcIummluasoeWvvOWFpeaPkOekulxcbuKAmOKAmCjku4XmmL7kuIDmrKEp4oCZ4oCZXCIsXG4gICAgICAgIGRlc2M6IFwi4oCY4oCY5LiL5ouJ5Yi35paw5Y2z5Y+v5pi+56S65LuT5bqT4oCZ4oCZXCIgKyBcIlxcbuinhOWImemHjOacieWlveWkmumakOiXj+eahOW8gOWFs+WTpu+8gVwiICsgXCJcXG7igJjigJjmj5DkvpvnmoTkvovlrZDkuZ/ku4XmmL7kuIDmrKHigJnigJlcIixcbiAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgfSk7XG4gICAgZGVwb3RTdGF0dXMuc2hvd1RpcHMgPSBmYWxzZTtcbiAgICB3cml0ZURlcG90U3RhdHVzVG9GaWxlKGRlcG90U3RhdHVzKTtcbn0gZWxzZSB7XG5cbiAgICBpZiAoZGVwb3RTdGF0dXMuc2hvd0V0YyAhPSBmYWxzZSB8fCBtUnVsZS52ZXJzaW9uICE9IGRlcG90U3RhdHVzLnZlcnNpb24pIHtcbiAgICAgICAgZGVwb3RTdGF0dXMuc2hvd0V0YyA9IGZhbHNlO1xuICAgICAgICBkZXBvdFN0YXR1cy52ZXJzaW9uID0gbVJ1bGUudmVyc2lvbjtcbiAgICAgICAgd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaGlkZVN5bWJvbHMucHVzaChcIlvkvovlrZBdXCIpO1xuICAgIH1cblxuICAgIGlmIChkZXBvdFN0YXR1cy5zaG93RGV2RG9jICE9IGZhbHNlKSB7XG4gICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogXCLjgJDlpKfkvazpgJrpgZPjgJFcXG7igJjigJgo5LuF5pi+5LiA5qyhKeKAmeKAmVwiLFxuICAgICAgICAgICAgZGVzYzogXCLigJjigJjngrnlh7vmn6XnnItWMuaAu+S7k+W6k+W8gOWPkeaWh+aho+KAmeKAmVxcbuinhOWImemHjOacieawuOS5heaYvuekuuW8gOWFs+WPr+S7peiHquW3seWOu+W8gFwiLFxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vZ2l0ZWUuY29tL1JlYm9ybl8wL0hpa2VyUnVsZXNEZXBvdC9ibG9iL21hc3Rlci9SRUFETUUubWQjZG9jdW1lbnQ9aHR0cHM6Ly9naXRlZS5jb20vUmVib3JuXzAvSGlrZXJSdWxlc0RlcG90L2Jsb2IvbWFzdGVyL1JFQURNRS5tZFwiLFxuICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgICAgIH0pO1xuICAgICAgICBkZXBvdFN0YXR1cy5zaG93RGV2RG9jID0gZmFsc2U7XG4gICAgICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpO1xuICAgIH1cblxuICAgIHZhciBkZXNjID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgcmV0dXJuIHJ1bGUub2xkVmVyc2lvbiAhPSBudWxsICYmIHJ1bGUub2xkVmVyc2lvbiA8IHJ1bGUudmVyc2lvbiA/IChcIuKAmOKAmOacieaWsOeJiOacrO+8mlwiICsgcnVsZS52ZXJzaW9uICsgXCLigJnigJnvvIzngrnlh7vlr7zlhaXmlrDniYjmnKxcIikgOiBydWxlLm9sZFZlcnNpb24gPiBydWxlLnZlcnNpb24gPyBcIuKAmOKAmOWWte+8n+S4uuWVpeS9oOeahOinhOWImeeJiOacrOavlOaIkei/mOmrmO+8n+KAmeKAmVwiIDogXCLlvZPliY3op4TliJnlt7LmmK/mnIDmlrDniYjvvIzngrnlh7vot7PliLDop4TliJnpobVcIjtcbiAgICB9O1xuXG4gICAgLy8g5Li65omA5pyJ5YiG57G75re75Yqg5oC75LuT5bqT6aG5XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIHJlbW90ZURlcG90UnVsZSA9IHt9O1xuICAgICAgICBldmFsKFwicmVtb3RlRGVwb3RSdWxlPVwiICsgZmV0Y2gocmVtb3RlRGVwb3RSdWxlVXJsLCB7fSkpO1xuICAgICAgICB2YXIgbG9jYWxEZXBvdFJ1bGUgPSBKU09OLnBhcnNlKGdldFJ1bGUoKSk7XG4gICAgICAgIHJlbW90ZURlcG90UnVsZS5vbGRWZXJzaW9uID0gbG9jYWxEZXBvdFJ1bGUudmVyc2lvbjtcbiAgICAgICAgLy9zZXRFcnJvcihKU09OLnN0cmluZ2lmeShsb2NhbERlcG90UnVsZSkpO1xuICAgICAgICAvL3NldEVycm9yKEpTT04uc3RyaW5naWZ5KHJlbW90ZURlcG90UnVsZSkpO1xuICAgICAgICBpZiAocmVtb3RlRGVwb3RSdWxlLm9sZFZlcnNpb24gPCByZW1vdGVEZXBvdFJ1bGUudmVyc2lvbikge1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogcmVtb3RlRGVwb3RSdWxlLnRpdGxlICsgXCJcXHRcIiArIGRlc2MocmVtb3RlRGVwb3RSdWxlKSxcbiAgICAgICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9iYWlkdS5jb20jXCIgKyBKU09OLnN0cmluZ2lmeShyZW1vdGVEZXBvdFJ1bGUpIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiLFxuICAgICAgICAgICAgICAgIGRlc2M6IFwi44CQ5pu05paw5pel5b+X44CRXFxu5pu05aSa5a6M5pW05pel5b+X6K+35Zyo6YeM6Z2i54K55Ye76L+b5YWl5Y6f572R6aG15p+l55yLXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZFswXS5kZXNjID0gXCLigJjigJjngrnlh7vlj6/mn6XnnIvmm7TmlrDml6Xlv5figJnigJk8YnI+XCIgKyBkWzBdLmRlc2M7XG4gICAgICAgICAgICBkWzBdLnVybCA9IFwiaHR0cHM6Ly9naXRlZS5jb20vcWl1c3Vuc2hpbmUyMzMvaGlrZXJWaWV3L2Jsb2IvbWFzdGVyL3J1bGV2ZXJzaW9uL0NIQU5HRUxPR19ERVBPVFJVTEVfVjIubWQjdXBkYXRlVGV4dD1cIiArIHJlbW90ZURlcG90UnVsZS51cGRhdGVUZXh0XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogXCLigJjigJjmgLvku5PlupPmm7TmlrDnqIvluo/lt7LmjZ/lnY/igJnigJlcIixcbiAgICAgICAgICAgIGRlc2M6IFwi6K+36IGU57O7IFwiICsgbVJ1bGUuYXV0aG9yICsgXCIg5L+u5aSNXCIsXG4gICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCIsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXV0aG9yTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXNIaWRlUnVsZShhdXRob3JMaXN0W2ldKSkge1xuICAgICAgICAgICAgYXV0aG9yTGlzdC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICBpLS07XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGljVXJsID0gbnVsbDtcbiAgICAgICAgdmFyIHBpY1VybEpTID0gYXV0aG9yTGlzdFtpXS5tYXRjaCgvcGljVXJsPS5bXFxzXFxTXSo/Jy8pICsgXCI7XCI7XG4gICAgICAgIGV2YWwocGljVXJsSlMpO1xuICAgICAgICBpZiAocGljVXJsID09IG51bGwpIHBpY1VybCA9IHBpY1VybExpc3RbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcGljVXJsTGlzdC5sZW5ndGgpXTtcbiAgICAgICAgLy8gc2V0RXJyb3IocGljVXJsKVxuICAgICAgICBkLnB1c2goe1xuICAgICAgICAgICAgdGl0bGU6IGF1dGhvckxpc3RbaV0uc3BsaXQoXCJAQFwiKVswXSxcbiAgICAgICAgICAgIHVybDogXCJodHRwczovL2JhaWR1LmNvbSNcIiArIGF1dGhvckxpc3RbaV0sXG4gICAgICAgICAgICBwaWNfdXJsOiBwaWNVcmxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyBzZXRFcnJvcihKU09OLnN0cmluZ2lmeShkKSk7XG5yZXMuZGF0YSA9IGQ7XG5zZXRIb21lUmVzdWx0KHJlcyk7Iiwic2VhcmNoX3VybCI6IiIsInRpdGxlQ29sb3IiOiIjZmZmMjBjMDAiLCJncm91cCI6IiPvuI/ig6PpppbpobUiLCJzZWFyY2hGaW5kIjoiIiwiZGV0YWlsX2NvbF90eXBlIjoidGV4dF8xIiwiZGV0YWlsX2ZpbmRfcnVsZSI6ImpzOlxudmFyIHJlcyA9IHt9O1xudmFyIGQgPSBbXTtcblxuLy8g6K6+572uIHRydWUg5LiA6ZSu5YeA5YyW77yM6Zmk5LqG6KeE5YiZ5ZKM5LuT5bqT6YCa55+l77yM5ZWl5Lmf5LiN6KaBXG52YXIgaGlkZUFsbCA9IGZhbHNlO1xuLy8g5bCP5LuT5bqT5qCH6aKY5byA5YWz77yI5rOo5oSP5LqL6aG55LiK6Z2i6YKj5Liq77yJ77yM5LiN6ZyA6KaB5pi+56S66K+36K6+572u5Li6dHJ1ZVxudmFyIG5vVGl0bGUgPSB0cnVlO1xuLy8g5rOo5oSP5LqL6aG55byA5YWz77yM5LiN6ZyA6KaB5pi+56S66K+36K6+572u5Li6dHJ1ZVxudmFyIG5vV2FybmluZyA9IGZhbHNlO1xuLy8g6KeE5YiZ5pWw6YeP5pi+56S65byA5YWz77yM5LiN6ZyA6KaB5pi+56S66K+36K6+572u5Li6dHJ1ZVxudmFyIG5vUnVsZXNOdW0gPSBmYWxzZTtcblxuLy8g5piv5ZCm5YWB6K646LaF6L+H5LiA5a6a6KeE5YiZ5pWw5ZCO5pS55Y+Y5pi+56S65qC35byP77yM6buY6K6k5LiN5byA5ZCvXG52YXIgbmVlZENoYW5nZVNob3dUeXBlID0gZmFsc2U7XG4vLyDorr7nva7mnIDlpKfmmL7npLrlrozmlbTmlofmnKznmoTop4TliJnmlbDvvIzlpKfkuo7orr7nva7lgLzliJnmmL7npLrkuLrmjInpkq7moLflvI8o6buY6K6kIHRleHRfMilcbnZhciBzaG93RnVsbFRleHRNYXggPSAxMDtcbi8vIOiuvue9rui2hei/h+WFgeiuuOaYvuekuuWujOaVtOaWh+acrOeahOinhOWImeaVsOWQjuaYvuekuueahOagt+W8j1xudmFyIG92ZXJNYXhTaG93VHlwZSA9IFwidGV4dF8yXCI7XG5cbi8qKlxuICog6KeE5YiZ5pig5bCE5YiX6KGoXG4gKiDlt6bmnKzlnLDvvIzlj7Pov5znq6/vvIzmnKzlnLDmmKDlsITkuLrov5znq6/vvIzovr7liLDmm7/mjaLlhoXlrrnnmoTnm67nmoTjgILmlK/mjIHmraPliJnmibnph4/mmKDlsIRcbiAqIO+8iOazqOaEj++8jOeoi+W6j+mAu+i+keS4uuWFiOaYoOWwhOWQjuaJp+ihjOS4i+mdoueahOWIoOmZpOagh+iusO+8iVxuICovXG52YXIgcnVsZXNNYXBwaW5nID0gW1xuICAgIC8vIFt7XCJ0aXRsZVwiOiBcIumihOWRiueJh+KAolRcIiwgXCJhdXRob3JcIjogXCJSZWJvcm5cIn0sIHtcInRpdGxlXCI6IFwi6aKE5ZGK54mH4oCiUmVcIiwgXCJhdXRob3JcIjogXCJSZWJvcm5cIn1dLFxuICAgIC8vIFt7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAolQpXCIsIFwiYXV0aG9yXCI6IFwiUmVib3JuXCJ9LCB7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAolJlKVwiLCBcImF1dGhvclwiOiBcIlJlYm9yblwifV1cbl07XG4vLyDkupHnq6/op4TliJnmmKDlsITliJfooajpk77mjqXvvIzmoLzlvI/mmK9KU09O5pWw57uE77yM6K+36Ieq5bex6K6+572uXG52YXIgcmVtb3RlUnVsZXNNYXBwaW5nVXJsID0gXCJcIjtcblxuLy8g5YWl5oiP5byA5YWz77yf77yI5ruR56i977yJLy8g5Yig6Zmk5byA5YWz77yM5LiN6ZyA6KaB5Yig6Zmk6K+36K6+572u5Li6ZmFsc2VcbnZhciBuZWVkRGVsU3ltYm9sID0gdHJ1ZTtcbi8vIOiHquihjOa3u+WKoOimgeiiq+WIoOaOieeahOagh+iusFxudmFyIHN5bWJvbHMgPSBbXCLmoIforrAxXCIsIFwi5qCH6K6wMlwiXTtcblxuLy8g6ZqQ6JeP5byA5YWz77yM5LiN6ZyA6KaB6ZqQ6JeP6K+36K6+572u5Li6ZmFsc2VcbnZhciBuZWVkSGlkZVJ1bGUgPSB0cnVlO1xuLy8g6Ieq6KGM5re75Yqg6KaB6ZqQ6JeP55qE5qCH6K6w77yM5qC85byP5Li677yaW+agh+iusOWQjV1cbnZhciBoaWRlU3ltYm9scyA9IFtcIlvmqKHmnb9dXCIsIFwiW+acquWujOaIkF1cIl07XG5cbi8vIOaYr+WQpumakOiXj+S+i+WtkO+8jOmcgOimgemakOiXj+ivt+iuvue9ruS4unRydWVcbnZhciBuZWVkSGlkZUV0YyA9IGZhbHNlO1xuaWYgKG5lZWRIaWRlRXRjID09IHRydWUpIGhpZGVTeW1ib2xzLnB1c2goXCJb5L6L5a2QXVwiKTtcblxuLy8g5LuT5bqT54q25oCB57yT5a2Y5paH5Lu25Zyw5Z2AXG52YXIgc3RhdHVzQ2FjaGVGaWxlID0gZ2V0VmFyKCdzdGF0dXNDYWNoZUZpbGUnKTtcbmlmIChzdGF0dXNDYWNoZUZpbGUgPT0gbnVsbCB8fCBzdGF0dXNDYWNoZUZpbGUgPT0gXCJcIikgc3RhdHVzQ2FjaGVGaWxlID0gXCJoaWtlcjovL2ZpbGVzL2RlcG90U3RhdHVzX3YyLmpzb25cIjtcbi8vIOS4vuS+iyBoaWtlcjovL2ZpbGVzL2RlcG90U3RhdHVzX3YyLmpzb25cbi8vIHNldEVycm9yKHN0YXR1c0NhY2hlRmlsZSk7XG5cbi8vIOiLpemcgOimgeWFs+mXreW/veeVpeacrOasoeabtOaWsOivt+iuvue9ruS4unRydWVcbnZhciBub0lnbm9yZVVwZGF0ZSA9IGZhbHNlO1xuLy8g5pys5Zyw5b+955Wl5pu05paw5YiX6KGo77yMXG4vLyDlhoXlrrnmqKHmnb/kuLoge3RpdGxlOiBcIuinhOWImeWQjVwiLCBhdXRob3I6IFwi6KeE5YiZ5L2c6ICFXCJ9XG52YXIgaWdub3JlVXBkYXRlUnVsZUxpc3QgPSBbXG4gLy8ge3RpdGxlOiBcIumihOWRiueJh+KAolJlXCIsIGF1dGhvcjogXCJSZWJvcm5cIn0sXG5dO1xuLy8g5LqR56uv5b+955Wl5pu05paw5YiX6KGo6ZO+5o6l77yM5qC85byP5pivSlNPTuaVsOe7hO+8jOivt+iHquW3seiuvue9rlxudmFyIHJlbW90ZUlnbm9yZUxpc3RVcmwgPSBcIlwiO1xuXG4vLyDlj4LogIPpk77mjqXvvJpcbi8vIGh0dHBzOi8vZ2l0ZWUuY29tL1JlYm9ybl8wL0hpa2VyUnVsZXNEZXBvdC9yYXcvbWFzdGVyL2lnbm9yZVVwZGF0ZVJ1bGVMaXN0Lmpzb25cbi8vIGh0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9yYXcvbWFzdGVyL3J1bGV2ZXJzaW9uL1JlYm9ybi9pZ25vcmVVcGRhdGVSdWxlTGlzdC5qc29uXG5cbnZhciByZW1vdGVJZ25vcmVMaXN0ID0gW107XG50cnkge1xuICAgIGV2YWwoXCJyZW1vdGVJZ25vcmVMaXN0PVwiICsgZmV0Y2gocmVtb3RlSWdub3JlTGlzdFVybCwge30pKTtcbn0gY2F0Y2ggKGUpIHtcbn1cbkFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGlnbm9yZVVwZGF0ZVJ1bGVMaXN0LCByZW1vdGVJZ25vcmVMaXN0KTtcbi8vIHNldEVycm9yKEpTT04uc3RyaW5naWZ5KHJlbW90ZUlnbm9yZUxpc3QpKTtcblxuXG52YXIgcmVtb3RlUnVsZXNNYXBwaW5nID0gW107XG50cnkge1xuICAgIGV2YWwoXCJyZW1vdGVSdWxlc01hcHBpbmc9XCIgKyBmZXRjaChyZW1vdGVSdWxlc01hcHBpbmdVcmwsIHt9KSk7XG59IGNhdGNoIChlKSB7XG59XG5BcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShydWxlc01hcHBpbmcsIHJlbW90ZVJ1bGVzTWFwcGluZyk7XG4vLyBzZXRFcnJvcihKU09OLnN0cmluZ2lmeShydWxlc01hcHBpbmcpKTtcblxuLy8g5rOo5oSP5LqL6aG55paH5a2XXG52YXIgd2FyaW5nVGV4dCA9IFwiMS4g5L+d5a2Y5ZCO6ZyA6KaB5omL5Yqo5LiL5ouJ5Yi35paw5omN6IO95pu05paw6KeE5YiZ54q25oCBXCIgKyBcIlxcbjIuIOaMiemSruW9oueKtueahOinhOWImeaYr+WkhOS6juacgOaWsOeJiOacrOeahO+8jOeCueWHu+WPr+i3s+i9rOiHs+inhOWImemhtVwiO1xuLy8g6aaW5qyh5a+85YWl5paH5a2XXG52YXIgZmlyc3RJbXBvcnRUZXh0ID0gXCIxLuKAmOKAmOS4i+aLieWIt+aWsOWNs+WPr+aYvuekuuS7k+W6k+inhOWImeKAmeKAmVwiICsgXCJcXG4yLuS6jOe6p+inhOWImeS4rSBuZWVkQ2hhbmdlU2hvd1R5cGUg5Y+v6K6+572u5pi+56S65qC35byPXCIgKyBcIlxcbjMu5LqM57qn6KeE5YiZ5LitIGhpZGVBbGwg5Y+v6K6+572u5LiA6ZSu6ZqQ6JeP5qCH6aKY5ZKM5rOo5oSP5LqL6aG5XCI7XG5cbi8qKlxuICog5Y+v5Zyo5q2k5aSE6Ieq5a6a5LmJ5LuT5bqT77yM5a6e546w56eB5Lq65LuT5bqTXG4gKlxuICog5LulUmVib3Ju5LuT5bqT55qE6ZO+5o6l5Li65Y+C6ICDXG4gKlxuICogaHR0cHM6Ly9naXRlZS5jb20vUmVib3JuXzAvSGlrZXJSdWxlc0RlcG90L2Jsb2IvbWFzdGVyL3VwZGF0ZS5qc29uXG4gKi9cbnZhciBhdXRob3JMaXN0ID0gZ2V0VXJsKCkuc3BsaXQoXCIjXCIpWzFdO1xudmFyIGF1dGhvckFuZE93bmVyQW5kUHJvamVjdCA9IGF1dGhvckxpc3Quc3BsaXQoXCJAQFwiKTtcbnZhciBhdXRob3IgPSBhdXRob3JBbmRPd25lckFuZFByb2plY3RbMF07XG52YXIgcmVtb3RlVXJsID0gXCJcIjtcblxudmFyIGFwaVR5cGUgPSBcIjFcIjsgIC8vIDAg5Li65paH5Lu255u06ZO+77yMMSDkuLrnoIHkupFBUElcbnZhciBhcGlUeXBlSlMgPSBhdXRob3JMaXN0Lm1hdGNoKC9hcGlUeXBlPS5bXFxzXFxTXSo/Jy8pICsgXCI7XCI7XG5ldmFsKGFwaVR5cGVKUyk7XG5pZiAoYXBpVHlwZSA9PSBudWxsKSBhcGlUeXBlID0gXCIxXCI7XG5cbmlmIChhcGlUeXBlID09IFwiMFwiKSB7XG4gICAgdmFyIGZ1bGxVcmwgPSBcIlwiO1xuICAgIHZhciBmdWxsVXJsSlMgPSBhdXRob3JMaXN0Lm1hdGNoKC9mdWxsVXJsPS5bXFxzXFxTXSo/Jy8pICsgXCI7XCI7XG4gICAgZXZhbChmdWxsVXJsSlMpO1xuICAgIHJlbW90ZVVybCA9IGZ1bGxVcmw7XG59IGVsc2UgaWYgKGFwaVR5cGUgPT0gXCIxXCIpIHtcbiAgICB2YXIgcmVtb3RlQXBpSG9tZSA9IFwiaHR0cHM6Ly9naXRlZS5jb20vYXBpL3Y1L3JlcG9zL1wiO1xuICAgIHZhciBvd25lciA9IGF1dGhvckFuZE93bmVyQW5kUHJvamVjdFsxXTsgICAvLyDku5PlupPmi6XmnInogIVcbiAgICB2YXIgcmVwbyA9IGF1dGhvckFuZE93bmVyQW5kUHJvamVjdFsyXTsgLy8g5LuT5bqT5ZCNXG4gICAgdmFyIHJlbW90ZUZpbGVuYW1lID0gbnVsbDsgLy8g5paH5Lu25ZCNXG4gICAgdmFyIHBhdGggPSByZW1vdGVGaWxlbmFtZTsgIC8vIOWcqOS7k+W6k+S4reaWh+S7tueahOi3r+W+hFxuICAgIHZhciBhY2Nlc3NfdG9rZW4gPSBudWxsOyAgLy8g55So5oi35o6I5p2D56CB77yM5Zyo56CB5LqRXCLorr7nva7igJQ+5a6J5YWo6K6+5a6aLT7kuKrkurrorr/pl67ku6TniYxcIuS4reWPr+S7peeUn+aIkFxuICAgIHZhciB0b2tlbkpTID0gYXV0aG9yTGlzdC5tYXRjaCgvYWNjZXNzX3Rva2VuPS5bXFxzXFxTXSo/Jy8pICsgXCI7XCI7XG4gICAgZXZhbCh0b2tlbkpTKTtcbiAgICAvLyBzZXRFcnJvcihhY2Nlc3NfdG9rZW49PW51bGwpO1xuICAgIHZhciByZW1vdGVGaWxlbmFtZUpTID0gYXV0aG9yTGlzdC5tYXRjaCgvcmVtb3RlRmlsZW5hbWU9LltcXHNcXFNdKj8nLykgKyBcIjtcIjtcbiAgICBldmFsKHJlbW90ZUZpbGVuYW1lSlMpO1xuICAgIGlmIChyZW1vdGVGaWxlbmFtZSA9PSBudWxsKSB7XG4gICAgfVxuICAgIHJlbW90ZUZpbGVuYW1lID0gXCJ1cGRhdGUuanNvblwiO1xuICAgIHBhdGggPSByZW1vdGVGaWxlbmFtZTtcbiAgICAvLyBzZXRFcnJvcihyZW1vdGVGaWxlbmFtZSlcbiAgICAvLyBBUEnpk77mjqXlj4LogIPvvJpodHRwczovL2dpdGVlLmNvbS9hcGkvdjUvcmVwb3Mve3tvd25lcn19L3t7cmVwb319L2NvbnRlbnRzL3t7cGF0aH19P2FjY2Vzc190b2tlbj0qKioqXG4gICAgcmVtb3RlVXJsID0gcmVtb3RlQXBpSG9tZSArIG93bmVyICsgXCIvXCIgKyByZXBvICsgXCIvY29udGVudHMvXCIgKyBwYXRoO1xuICAgIGlmIChhY2Nlc3NfdG9rZW4gIT0gbnVsbCkge1xuICAgICAgICByZW1vdGVVcmwgPSByZW1vdGVVcmwgKyBcIj9hY2Nlc3NfdG9rZW49XCIgKyBhY2Nlc3NfdG9rZW47XG4gICAgfVxuICAgIC8vIHNldEVycm9yKHJlbW90ZVVybCk7XG4gICAgLy8gdmFyIHJlbW90ZUhvbWUgPSBcImh0dHBzOi8vZ2l0ZWUuY29tL1wiICsgb3duZXIgKyBcIi9cIiArIHJlcG8gKyBcIi9ibG9iL21hc3Rlci91cGRhdGUuanNvblwiO1xufVxuXG4vLyDmiormgLvku5PlupPnirbmgIHlhpnlhaXmlofku7ZcbmZ1bmN0aW9uIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpIHtcbiAgICB3cml0ZUZpbGUoc3RhdHVzQ2FjaGVGaWxlLCBKU09OLnN0cmluZ2lmeShkZXBvdFN0YXR1cykpO1xufVxuXG4vLyDoi6XkuI3mmK/nrKzkuIDmrKHkvb/nlKjmgLvku5PlupPliJnpmpDol4/lvIDlj5HmlofmoaNcbnZhciBkZXBvdFN0YXR1cyA9IHt9O1xudmFyIGRlcG90U3RhdHVzRmlsZSA9IGZldGNoKHN0YXR1c0NhY2hlRmlsZSwge30pO1xuaWYgKGRlcG90U3RhdHVzRmlsZSAhPSBcIlwiKSB7XG4gICAgZXZhbChcImRlcG90U3RhdHVzPVwiICsgZGVwb3RTdGF0dXNGaWxlKTtcbn1cbi8vIOiLpemcgOimgeawuOS5heaYvuekuuaPkOekuu+8jOWImeWPlua2iOazqOmHilxuLy8gZGVwb3RTdGF0dXMuc2hvd1NlY29uZExpc3RUaXBzID0gdHJ1ZTtcblxuaWYgKGdldFVybCgpLmluZGV4T2YoXCJydWxlOi8vXCIpICE9IC0xKSB7XG4gICAgdmFyIHJlbW90ZURlcG90UnVsZSA9IEpTT04ucGFyc2UoZ2V0VXJsKCkuc3BsaXQoXCIjXCIpWzFdKTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLmm7TmlrDml6Xlv5cgKOeCueWHu+WPr+afpeeci+WujOaVtOaXpeW/lylcIixcbiAgICAgICAgZGVzYzogcmVtb3RlRGVwb3RSdWxlLnVwZGF0ZVRleHQsXG4gICAgICAgIHVybDogXCJodHRwczovL2dpdGVlLmNvbS9xaXVzdW5zaGluZTIzMy9oaWtlclZpZXcvYmxvYi9tYXN0ZXIvcnVsZXZlcnNpb24vQ0hBTkdFTE9HX0RFUE9UUlVMRV9WMi5tZFwiLFxuICAgICAgICBjb2xfdHlwZTogXCJwaWNfMVwiXG4gICAgfSk7XG4gICAgZC5wdXNoKHtcbiAgICAgICAgdGl0bGU6IFwi54K55Ye75pu05paw5oC75LuT5bqTXCIsXG4gICAgICAgIHVybDogcmVtb3RlRGVwb3RSdWxlLnJ1bGUsXG4gICAgICAgIGNvbF90eXBlOiBcInRleHRfY2VudGVyXzFcIlxuICAgIH0pO1xufSBlbHNlIGlmIChnZXRVcmwoKS5pbmRleE9mKFwidXBkYXRlVGV4dD1cIikgIT0gLTEpIHtcbiAgICB2YXIgdXBkYXRlVGV4dCA9IG51bGw7XG4gICAgLy8gdXBkYXRlVGV4dEpTID0gXCJ1cGRhdGVUZXh0PSdcIiArIGdldFVybCgpLnNwbGl0KFwiI1wiKVsxXS5yZXBsYWNlKFwidXBkYXRlVGV4dD1cIiwgXCJcIikgKyBcIic7XCI7XG4gICAgLy8gZXZhbCh1cGRhdGVUZXh0SlMpO1xuICAgIHVwZGF0ZVRleHQgPSBnZXRVcmwoKS5zcGxpdChcIiNcIilbMV0ucmVwbGFjZShcInVwZGF0ZVRleHQ9XCIsIFwiXCIpO1xuICAgIGQucHVzaCh7XG4gICAgICAgIHRpdGxlOiBcIuabtOaWsOaXpeW/lyAo54K55Ye75Y+v5p+l55yL5a6M5pW05pel5b+XKVwiLFxuICAgICAgICBkZXNjOiB1cGRhdGVUZXh0ICE9IG51bGwgPyB1cGRhdGVUZXh0IDogXCLmmoLml6Dmm7TmlrDml6Xlv5dcIixcbiAgICAgICAgdXJsOiBcImh0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9ibG9iL21hc3Rlci9ydWxldmVyc2lvbi9DSEFOR0VMT0dfREVQT1RSVUxFX1YyLm1kXCIsXG4gICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICB9KTtcbn0gZWxzZSBpZiAoZ2V0VXJsKCkuaW5kZXhPZihcImRvY3VtZW50PVwiKSAhPSAtMSkge1xuICAgIHZhciBkb2N1bWVudFVybCA9IG51bGw7XG4gICAgZG9jdW1lbnRVcmwgPSBnZXRVcmwoKS5zcGxpdChcIiNcIilbMV0ucmVwbGFjZShcImRvY3VtZW50PVwiLCBcIlwiKTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLmgLvku5PlupPlvIDlj5HmlofmoaPlhaXlj6NcIixcbiAgICAgICAgZGVzYzogXCLov5nmmK/kuJPpl6jnu5nlpKfkvazku6zlhpnnmoTvvIzmlofnrJTlpKrlt67kuobvvIzop4nlvpflhpnlvpfkubHov5jor7fkvZPosIXkuIDkuIvwn5mI44CC5pyJ5LiN5oeC55qE5Zyw5pa55Y+v5Lul6IGU57O75oiR77yM5rqc5LqG5rqc5LqG772eXCIsXG4gICAgICAgIHVybDogZG9jdW1lbnRVcmwsXG4gICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICB9KTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLngrnlh7vlj6/mn6XnnIvlrozmlbTmlofmoaNcIixcbiAgICAgICAgdXJsOiBkb2N1bWVudFVybCxcbiAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgfSk7XG59IGVsc2Uge1xuXG4gICAgZnVuY3Rpb24gZ2V0UnVsZU5vU3ltYm9scyhydWxlLCBzeW1ib2xMaXN0KSB7XG4gICAgICAgIGlmIChuZWVkRGVsU3ltYm9sICE9IHRydWUpIHJldHVybiBydWxlO1xuICAgICAgICB2YXIgcnVsZVRlbXAgPSBydWxlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN5bWJvbExpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzeW1ib2xSZWcgPSBuZXcgUmVnRXhwKHN5bWJvbExpc3RbaV0sIFwiZ1wiKTtcbiAgICAgICAgICAgIHJ1bGVUZW1wLnRpdGxlID0gcnVsZVRlbXAudGl0bGUucmVwbGFjZShzeW1ib2xSZWcsIFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vc2V0RXJyb3IoSlNPTi5zdHJpbmdpZnkocnVsZVRlbXApKTtcbiAgICAgICAgcmV0dXJuIHJ1bGVUZW1wO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSGlkZVJ1bGUocnVsZSkge1xuICAgICAgICBpZiAobmVlZEhpZGVSdWxlICE9IHRydWUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgLy8gaWYgKGhpZGVTeW1ib2xzLmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBydWxlVGVtcCA9IHJ1bGU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGlkZVN5bWJvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChydWxlVGVtcC50aXRsZS5pbmRleE9mKGhpZGVTeW1ib2xzW2ldKSAhPSAtMSkgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIOWmguaenOacrOWcsOayoeacieWImeaPkOekuuWvvOWFpeaWsOinhOWImVxuICAgIC8vIOWboOmDqOWIhuaJi+acuuS4jeaUr+aMgWVzNuivreazle+8jOaVheazqOmHiuaOiVxuICAgIC8qdmFyIG15UnVsZXNNYXAgPSBuZXcgTWFwKCk7XG4gICAgbXlSdWxlcy5tYXAocnVsZSA9PiB7XG4gICAgICAgIG15UnVsZXNNYXAuc2V0KHJ1bGUudGl0bGUsIHRydWUpO1xuICAgIH0pO1xuICAgIC8vc2V0RXJyb3IobXlSdWxlc01hcC5nZXQoXCLohb7orq/igKJSZVwiKSk7Ki9cblxuICAgIGZ1bmN0aW9uIGdldFJ1bGVJbkFycmF5KHJ1bGVzLCBydWxlKSB7XG4gICAgICAgIGlmIChydWxlcyA9PSBudWxsIHx8IHJ1bGVzLmxlbmd0aCA9PSAwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHJ1bGVzW2ldLnRpdGxlID09IHJ1bGUudGl0bGUgJiYgcnVsZXNbaV0uYXV0aG9yID09IGF1dGhvcikgcmV0dXJuIHJ1bGVzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIOWOn+Wni+aWueazle+8jOavlOi+g+iAl+aXtlxuICAgIGZ1bmN0aW9uIGlzSW5BcnJheShydWxlcywgcnVsZSkge1xuICAgICAgICBpZiAoZ2V0UnVsZUluQXJyYXkocnVsZXMsIHJ1bGUpICE9IG51bGwpIHJldHVybiB0cnVlO1xuICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0lnbm9yZVVwZGF0ZVJ1bGUocnVsZSkge1xuICAgICAgICBpZiAoaXNJbkFycmF5KGlnbm9yZVVwZGF0ZVJ1bGVMaXN0LCBydWxlKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICB2YXIgY2FjaGVJZ25vcmVSdWxlID0gZ2V0UnVsZUluQXJyYXkoZGVwb3RTdGF0dXMuaWdub3JlVXBkYXRlUnVsZUxpc3QsIHJ1bGUpO1xuICAgICAgICAgICAgaWYgKGNhY2hlSWdub3JlUnVsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRlcG90U3RhdHVzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0ID09IG51bGwpIGRlcG90U3RhdHVzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgY2FjaGVJZ25vcmVSdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogcnVsZS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBhdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246IHJ1bGUudmVyc2lvblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZGVwb3RTdGF0dXMuaWdub3JlVXBkYXRlUnVsZUxpc3QucHVzaChjYWNoZUlnbm9yZVJ1bGUpO1xuICAgICAgICAgICAgICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChydWxlLnZlcnNpb24gIT0gY2FjaGVJZ25vcmVSdWxlLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVJZ25vcmVSdWxlLnZlcnNpb24gPSBydWxlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRJZ25vcmVVcGRhdGVSdWxlKHJ1bGUpIHtcbiAgICAgICAgaWYgKGlzSWdub3JlVXBkYXRlUnVsZShydWxlKSA9PSB0cnVlKSBydWxlLmlzSWdub3JlVXBkYXRlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgcnVsZXMgPSBbXTtcbiAgICBldmFsKFwicnVsZXM9XCIgKyBmZXRjaChcImhpa2VyOi8vaG9tZVwiLCB7fSkpO1xuICAgIHZhciBteVJ1bGVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcnVsZSA9IHJ1bGVzW2ldO1xuICAgICAgICBpZiAocnVsZS5hdXRob3IgPT0gYXV0aG9yKSB7XG4gICAgICAgICAgICBteVJ1bGVzLnB1c2goZ2V0UnVsZU5vU3ltYm9scyhydWxlLCBzeW1ib2xzKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gc2V0RXJyb3IoSlNPTi5zdHJpbmdpZnkobXlSdWxlcykpO1xuXG4gICAgZnVuY3Rpb24gZ2V0UnVsZUluUnVsZXNXaXRoTWFwcGluZyhydWxlcywgcnVsZSkge1xuICAgICAgICBpZiAocnVsZXMgPT0gbnVsbCB8fCBydWxlcy5sZW5ndGggPT0gMCB8fCBydWxlID09IG51bGwgfHwgcnVsZS5tYXBwaW5nVGl0bGUgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChydWxlc1tpXS5tYXBwaW5nVGl0bGUgIT1udWxsICYmIHJ1bGVzW2ldLm1hcHBpbmdUaXRsZSA9PSBydWxlLm1hcHBpbmdUaXRsZSAmJiBydWxlc1tpXS5hdXRob3IgPT0gYXV0aG9yKSByZXR1cm4gcnVsZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpIHtcbiAgICAgICAgaWYgKGdldFJ1bGVJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpICE9IG51bGwpIHJldHVybiB0cnVlO1xuICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgZGVzYyA9IGZ1bmN0aW9uIChydWxlcywgcnVsZSkge1xuICAgICAgICBpZiAoaXNJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpID09IHRydWUgfHwgaXNJbkFycmF5KHJ1bGVzLCBydWxlKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gcnVsZS5vbGRWZXJzaW9uICE9IG51bGwgJiYgcnVsZS5vbGRWZXJzaW9uIDwgcnVsZS52ZXJzaW9uID8gKFwi4oCY4oCY5pyJ5paw54mI5pys77yaXCIgKyBydWxlLnZlcnNpb24gKyBcIuKAmeKAme+8jOeCueWHu+WvvOWFpeaWsOeJiOacrFwiKSArIChcIjxicj48YnI+W+abtOaWsOaXpeW/l10gXCIgKyAocnVsZS51cGRhdGVUZXh0ID09IG51bGwgPyBcIuaXoFwiIDogcnVsZS51cGRhdGVUZXh0KSArIChydWxlLnRpcHMgIT0gbnVsbCAmJiBydWxlLnRpcHMgIT0gXCJcIiA/IFwiPGJyPjxicj5UaXBzOiBcIiArIHJ1bGUudGlwcyA6IFwiXCIpKSA6IHJ1bGUub2xkVmVyc2lvbiA+IHJ1bGUudmVyc2lvbiA/IFwi4oCY4oCY5Za177yf5Li65ZWl5L2g55qE6KeE5YiZ54mI5pys5q+U5oiR6L+Y6auY77yf4oCZ4oCZXCIgOiBcIuW9k+WJjeinhOWImeW3suaYr+acgOaWsOeJiO+8jOeCueWHu+i3s+WIsOinhOWImemhtVwiICsgKHJ1bGUudGlwcyAhPSBudWxsICYmIHJ1bGUudGlwcyAhPSBcIlwiID8gXCJcXG5cXG5UaXBzOiBcIiArIHJ1bGUudGlwcyA6IFwiXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwi4oCY4oCY5L2g5bCa5pyq5a+85YWl6K+l6KeE5YiZ4oCZ4oCZ77yM54K55Ye75a+85YWlXCIgKyAocnVsZS50aXBzICE9IG51bGwgJiYgcnVsZS50aXBzICE9IFwiXCIgPyBcIjxicj48YnI+VGlwczogXCIgKyBydWxlLnRpcHMgOiBcIlwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoZGVwb3RTdGF0dXMuc2hvd1NlY29uZExpc3RUaXBzICE9IGZhbHNlKSB7XG4gICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogXCLpppbmrKHlr7zlhaXmj5DnpLpcXG7igJjigJgo5LuF5pi+5LiA5qyhKeKAmeKAmVwiLFxuICAgICAgICAgICAgZGVzYzogZmlyc3RJbXBvcnRUZXh0LFxuICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgICAgIH0pO1xuICAgICAgICBkZXBvdFN0YXR1cy5zaG93U2Vjb25kTGlzdFRpcHMgPSBmYWxzZTtcbiAgICAgICAgd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKG5vVGl0bGUgIT0gdHJ1ZSAmJiBoaWRlQWxsICE9IHRydWUpIHtcbiAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IFwi4oCY4oCY6L+Z6YeM5pivIFwiICsgYXV0aG9yICsgXCIg55qE6KeE5YiZ5bCP5LuT5bqT4oCZ4oCZXCIsXG4gICAgICAgICAgICAgICAgLy8gZGVzYzogXCLngrnlh7vlj6/orr/pl67op4TliJnku5PlupPmupBcIixcbiAgICAgICAgICAgICAgICAvLyB1cmw6IHJlbW90ZUhvbWUsXG4gICAgICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlbW90ZVJ1bGVzID0gW107XG4gICAgICAgIC8vIHZhciByZW1vdGVVcmwgPSByZW1vdGVBcGlIb21lICsgZW5jb2RlVVJJQ29tcG9uZW50KGF1dGhvcikgKyBcIi9cIiArIHJlbW90ZUZpbGVuYW1lO1xuICAgICAgICB2YXIgcmVtb3RlU291cmNlID0gZmV0Y2gocmVtb3RlVXJsLCB7fSk7XG4gICAgICAgIC8vIHNldEVycm9yKHJlbW90ZVVybCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBldmFsKFwicmVtb3RlU291cmNlPVwiICsgcmVtb3RlU291cmNlKTtcbiAgICAgICAgICAgIGlmIChhcGlUeXBlID09IFwiMFwiKSB7XG4gICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMgPSByZW1vdGVTb3VyY2U7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFwaVR5cGUgPT0gXCIxXCIpIHtcbiAgICAgICAgICAgICAgICBldmFsKFwicmVtb3RlUnVsZXM9XCIgKyBiYXNlNjREZWNvZGUocmVtb3RlU291cmNlLmNvbnRlbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1vdGVSdWxlcy5kYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm90aWNlID0gcmVtb3RlUnVsZXMubm90aWNlO1xuICAgICAgICAgICAgICAgIGlmIChub3RpY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChub3RpY2UpID09IFwic3RyaW5nXCIgJiYgbm90aWNlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwi5LuT5bqT6YCa55+lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogbm90aWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiAobm90aWNlKSA9PSBcIm9iamVjdFwiICYmIG5vdGljZS5kZXNjICE9IG51bGwgJiYgbm90aWNlLmRlc2MgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbm90aWNlLnRpdGxlICE9IG51bGwgJiYgbm90aWNlLnRpdGxlICE9IFwiXCIgPyBub3RpY2UudGl0bGUgOiBcIuS7k+W6k+mAmuefpVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IG5vdGljZS5kZXNjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY191cmw6IG5vdGljZS5waWNVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sX3R5cGU6IFwicGljXzFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMgPSByZW1vdGVSdWxlcy5kYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5vV2FybmluZyAhPSB0cnVlICYmIGhpZGVBbGwgIT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIuazqOaEj+S6i+mhuVwiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiB3YXJpbmdUZXh0LFxuICAgICAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJwaWNfMVwiLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaGlrZXI6Ly9ob21lQOaAu+S7k+W6k1wiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgfVxuICAgICAgICAvL3NldEVycm9yKHJlbW90ZVJ1bGVzLmxlbmd0aCk7XG4gICAgICAgIGlmIChyZW1vdGVSdWxlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9zZXRFcnJvcihteVJ1bGVzLmxlbmd0aCk7XG4gICAgICAgICAgICBpZiAobXlSdWxlcy5sZW5ndGggPj0gcmVtb3RlUnVsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8g5LiN55+l6YGT5Lya5LiN5Lya5pyJ6Zeu6aKYXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBteVJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmVtb3RlUnVsZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFJ1bGUgPSBteVJ1bGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVJ1bGUgPSByZW1vdGVSdWxlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0hpZGVSdWxlKHJlbW90ZVJ1bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMuc3BsaWNlKGosIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGotLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNldElnbm9yZVVwZGF0ZVJ1bGUocmVtb3RlUnVsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcnVsZXNNYXBwaW5nLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlTWFwcGluZyA9IHJ1bGVzTWFwcGluZ1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUnVsZU1hcHBpbmdUaXRsZSA9IHJ1bGVNYXBwaW5nWzBdLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGVSZWdleCA9IG5ldyBSZWdFeHAobG9jYWxSdWxlTWFwcGluZ1RpdGxlLCBcImdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUnVsZS5tYXBwaW5nVGl0bGUgPSBsb2NhbFJ1bGUudGl0bGUubWF0Y2godGl0bGVSZWdleClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVSdWxlTWFwcGluZ1RpdGxlID0gcnVsZU1hcHBpbmdbMV0udGl0bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlUmVnZXggPSBuZXcgUmVnRXhwKHJlbW90ZVJ1bGVNYXBwaW5nVGl0bGUsIFwiZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5tYXBwaW5nVGl0bGUgPSByZW1vdGVSdWxlLnRpdGxlLm1hdGNoKHRpdGxlUmVnZXgpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxSdWxlLm1hcHBpbmdUaXRsZSA9PSByZW1vdGVSdWxlLm1hcHBpbmdUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5sb2NhbFRpdGxlID0gbG9jYWxSdWxlLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5pc01hcHBlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLm9sZFZlcnNpb24gPSBsb2NhbFJ1bGUudmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsUnVsZS50aXRsZSA9PSByZW1vdGVSdWxlLnRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5vbGRWZXJzaW9uID0gbG9jYWxSdWxlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdGVSdWxlc1tqXS5ydWxlPW15UnVsZXNbaV0ucnVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW90ZVJ1bGVzW2pdLmRlc2M9bXlSdWxlc1tpXS5kZXNjO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVtb3RlUnVsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVJ1bGUgPSByZW1vdGVSdWxlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChpc0hpZGVSdWxlKHJlbW90ZVJ1bGUpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaS0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2V0SWdub3JlVXBkYXRlUnVsZShyZW1vdGVSdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBteVJ1bGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxSdWxlID0gbXlSdWxlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBydWxlc01hcHBpbmcubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJ1bGVNYXBwaW5nID0gcnVsZXNNYXBwaW5nW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxSdWxlTWFwcGluZ1RpdGxlID0gcnVsZU1hcHBpbmdbMF0udGl0bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZVJlZ2V4ID0gbmV3IFJlZ0V4cChsb2NhbFJ1bGVNYXBwaW5nVGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFJ1bGUubWFwcGluZ1RpdGxlID0gbG9jYWxSdWxlLnRpdGxlLm1hdGNoKHRpdGxlUmVnZXgpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3RlUnVsZU1hcHBpbmdUaXRsZSA9IHJ1bGVNYXBwaW5nWzFdLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVJlZ2V4ID0gbmV3IFJlZ0V4cChyZW1vdGVSdWxlTWFwcGluZ1RpdGxlLCBcImdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGUubWFwcGluZ1RpdGxlID0gcmVtb3RlUnVsZS50aXRsZS5tYXRjaCh0aXRsZVJlZ2V4KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsUnVsZS5tYXBwaW5nVGl0bGUgPT0gcmVtb3RlUnVsZS5tYXBwaW5nVGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGUubG9jYWxUaXRsZSA9IGxvY2FsUnVsZS50aXRsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGUuaXNNYXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5vbGRWZXJzaW9uID0gbG9jYWxSdWxlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsUnVsZS50aXRsZSA9PSByZW1vdGVSdWxlLnRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5vbGRWZXJzaW9uID0gbG9jYWxSdWxlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdGVSdWxlc1tpXS5ydWxlPW15UnVsZXNbal0ucnVsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW90ZVJ1bGVzW2ldLmRlc2M9bXlSdWxlc1tqXS5kZXNjO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1lcmdlU29ydChhcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAobGVuIDwgMikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbWlkZGxlID0gTWF0aC5mbG9vcihsZW4gLyAyKSxcbiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IGFyci5zbGljZSgwLCBtaWRkbGUpLFxuICAgICAgICAgICAgICAgICAgICByaWdodCA9IGFyci5zbGljZShtaWRkbGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtZXJnZShtZXJnZVNvcnQobGVmdCksIG1lcmdlU29ydChyaWdodCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBtZXJnZShsZWZ0LCByaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgaWdub3JlVXBkYXRlTGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBpc1RoaXNWZXJzaW9uTGlzdCA9IFtdO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKGxlZnQubGVuZ3RoID4gMCAmJiByaWdodC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0WzBdLmlzSWdub3JlVXBkYXRlID09IHRydWUgJiYgbGVmdFswXS5vbGRWZXJzaW9uICE9IGxlZnRbMF0udmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlVXBkYXRlTGlzdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmlnaHRbMF0uaXNJZ25vcmVVcGRhdGUgPT0gdHJ1ZSAmJiByaWdodFswXS5vbGRWZXJzaW9uICE9IHJpZ2h0WzBdLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlnbm9yZVVwZGF0ZUxpc3QucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsZWZ0WzBdLm9sZFZlcnNpb24gPCBsZWZ0WzBdLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmlnaHRbMF0ub2xkVmVyc2lvbiA8IHJpZ2h0WzBdLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxlZnRbMF0ub2xkVmVyc2lvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChsZWZ0LnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJpZ2h0WzBdLm9sZFZlcnNpb24gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocmlnaHQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1RoaXNWZXJzaW9uTGlzdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1RoaXNWZXJzaW9uTGlzdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd2hpbGUgKGlnbm9yZVVwZGF0ZUxpc3QubGVuZ3RoKSByZXN1bHQucHVzaChpZ25vcmVVcGRhdGVMaXN0LnNoaWZ0KCkpO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKGlzVGhpc1ZlcnNpb25MaXN0Lmxlbmd0aCkgcmVzdWx0LnB1c2goaXNUaGlzVmVyc2lvbkxpc3Quc2hpZnQoKSk7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAobGVmdC5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAocmlnaHQubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlbW90ZVJ1bGVzID0gbWVyZ2VTb3J0KHJlbW90ZVJ1bGVzKTtcblxuICAgICAgICAgICAgaWYgKG5vUnVsZXNOdW0gIT0gdHJ1ZSAmJiBoaWRlQWxsICE9IHRydWUpXG4gICAgICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiPGI+6K+l5LuT5bqT5YWx5pyJIOKAmOKAmFwiICsgcmVtb3RlUnVsZXMubGVuZ3RoICsgXCLigJnigJkg5p2h6KeE5YiZPGIvPlwiLFxuICAgICAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0XzFcIlxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzZXRFcnJvcihKU09OLnN0cmluZ2lmeShyZW1vdGVSdWxlcykpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW1vdGVSdWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBqID0gcmVtb3RlUnVsZXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIHJ1bGVXaXRoTWFwcGluZyA9IGdldFJ1bGVJblJ1bGVzV2l0aE1hcHBpbmcocmVtb3RlUnVsZXMsIGopO1xuICAgICAgICAgICAgICAgIGlmIChydWxlV2l0aE1hcHBpbmcgIT0gbnVsbCAmJiBnZXRSdWxlSW5SdWxlc1dpdGhNYXBwaW5nKG15UnVsZXMsIGopKSBqID0gcnVsZVdpdGhNYXBwaW5nO1xuICAgICAgICAgICAgICAgIHZhciByID0ge307XG4gICAgICAgICAgICAgICAgaWYgKG5lZWRDaGFuZ2VTaG93VHlwZSA9PSB0cnVlICYmIGoub2xkVmVyc2lvbiAhPSBudWxsICYmIGoub2xkVmVyc2lvbiA+PSBqLnZlcnNpb24gJiYgcmVtb3RlUnVsZXMubGVuZ3RoID4gc2hvd0Z1bGxUZXh0TWF4KSByLmNvbF90eXBlID0gb3Zlck1heFNob3dUeXBlO1xuICAgICAgICAgICAgICAgIHIuZGVzYyA9IChub0lnbm9yZVVwZGF0ZSAhPSB0cnVlICYmIGouaXNJZ25vcmVVcGRhdGUgPT0gdHJ1ZSkgJiYgKGoub2xkVmVyc2lvbiA9PSBudWxsIHx8IGoub2xkVmVyc2lvbiA8IGoudmVyc2lvbikgPyBcIuivpeinhOWImeW3suW/veeVpeacrOasoeabtOaWsFwiIDogZGVzYyhteVJ1bGVzLCBqKTtcbiAgICAgICAgICAgICAgICByLnRpdGxlID0gai5tYXBwaW5nVGl0bGUgIT0gbnVsbCAmJiBqLm1hcHBpbmdUaXRsZSAhPSBcIlwiICYmIGouaXNNYXBwZWQgPT0gdHJ1ZT8gai5tYXBwaW5nVGl0bGUgOiBqLnRpdGxlO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8g6ZyA6KaB6L+c56uvIE1hcHBpbmcg5pys5ZywXG4gICAgICAgICAgICAgICAgci51cmwgPSBpc0luQXJyYXkobXlSdWxlcywgaikgfHwgai5pc01hcHBlZCA9PSB0cnVlPyAoai5vbGRWZXJzaW9uICE9IG51bGwgJiYgai5vbGRWZXJzaW9uIDwgai52ZXJzaW9uID8gKGoucnVsZSB8fCBcIlwiKSA6IChcImhpa2VyOi8vaG9tZUBcIiArIChqLmxvY2FsVGl0bGUgIT0gbnVsbCAmJiBqLmxvY2FsVGl0bGUgIT0gXCJcIiA/IGoubG9jYWxUaXRsZSA6IGoudGl0bGUpKSkgOiAoai5ydWxlIHx8IFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vci5jb250ZW50ID0gai51cGRhdGVUZXh0O1xuICAgICAgICAgICAgICAgIGQucHVzaChyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxufVxucmVzLmRhdGEgPSBkO1xuc2V0SG9tZVJlc3VsdChyZXMpOyIsInNkZXRhaWxfY29sX3R5cGUiOiJtb3ZpZV8xIiwic2RldGFpbF9maW5kX3J1bGUiOiIifQ==" 
}