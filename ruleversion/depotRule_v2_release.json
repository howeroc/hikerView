{
    "title": "总仓库",
    "author": "Reborn",
    "version": 29,
    "updateText": "1.‘‘优化’’:所有开关都移到最前面的settings对象啦!(方便大佬们自己定义开关)\n2.‘‘新功能’’:支持规则映射功能(即替换规则名跟仓库规则对比)\n3.更多更新日志请点击访问源网页查看",
    "rule": "rule://5rW36ZiU6KeG55WM6KeE5YiZ5YiG5Lqr77yM5b2T5YmN5YiG5Lqr55qE5piv77ya6aaW6aG16aKR6YGT77yMUmVib3Ju77+laG9tZV9ydWxl77+leyJmaXJzdEhlYWRlciI6ImNsYXNzIiwidGl0bGUiOiLmgLvku5PlupMiLCJhdXRob3IiOiJSZWJvcm4iLCJ1cmwiOiJoaWtlcjovL2hvbWUiLCJ2ZXJzaW9uIjoyOSwiY29sX3R5cGUiOiJpY29uXzIiLCJjbGFzc19uYW1lIjoiIiwiY2xhc3NfdXJsIjoiIiwiYXJlYV9uYW1lIjoiIiwiYXJlYV91cmwiOiIiLCJ5ZWFyX25hbWUiOiIiLCJ5ZWFyX3VybCI6IiIsImZpbmRfcnVsZSI6ImpzOlxudmFyIHJlcyA9IHt9O1xudmFyIGQgPSBbXTtcbnZhciBtUnVsZSA9IEpTT04ucGFyc2UoZ2V0UnVsZSgpKTtcblxuLy8g5LuT5bqT5Liq5oCn6K6+572uXG52YXIgc2V0dGluZ3MgPSB7XG4gICAgLy8g5Zyo6L+Z6YeM5re75Yqg5LuT5bqT6YWN572u77yM5Y+v5L2/5pys5Zyw5re75Yqg55qE5LuT5bqT572u6aG2XG4gICAgYXV0aG9yTGlzdDogW1xuICAgICAgICBcIlvkvovlrZBd572u6aG256eB5Lq65LuT5bqTQEBSZWJvcm5fMEBASGlrZXJSdWxlc1ByaXZhY3lAQGFjY2Vzc190b2tlbj0nKioqKidcIixcbiAgICAgICAgXCJb5L6L5a2QXeiHquWumuS5ieaWh+S7tuWQjUBAUmVib3JuXzBAQEhpa2VyUnVsZXNEZXBvdEBAcmVtb3RlRmlsZW5hbWU9J3VwZGF0ZV8xLmpzb24nXCJcbiAgICBdLFxuICAgIHJlbW90ZUF1dGhvckxpc3RVcmw6IFwiaHR0cHM6Ly9naXRlZS5jb20vcWl1c3Vuc2hpbmUyMzMvaGlrZXJWaWV3L3Jhdy9tYXN0ZXIvcnVsZXZlcnNpb24vYXV0aG9yTGlzdC5qc29uXCIsXG4gICAgLy8g5Zyo6L+Z6YeM5re75Yqg5LuT5bqT6YWN572u77yM5Y+v5L2/5pys5Zyw5re75Yqg55qE5LuT5bqT572u5bqVXG4gICAgYXV0aG9yTGlzdEJvdHRvbTogW1xuICAgICAgICBcIlvkvovlrZBd572u5bqV5pys5Zyw5LuT5bqTQEBSZWJvcm5fMEBASGlrZXJSdWxlc1ByaXZhY3lcIlxuICAgIF0sXG4gICAgLy8g5Zyo6L+Z6YeM5re75Yqg6ZqP5py65aS05YOPXG4gICAgcGljVXJsTGlzdDogW1xuICAgICAgICBcImh0dHBzOi8vd3d3LmVhc3lpY29uLm5ldC9hcGkvcmVzaXplQXBpLnBocD9pZD0xMjcxNjI0JnNpemU9MTI4XCIsXG4gICAgICAgIFwiaHR0cHM6Ly93d3cuZWFzeWljb24ubmV0L2FwaS9yZXNpemVBcGkucGhwP2lkPTEyNzE2NDcmc2l6ZT0xMjhcIixcbiAgICAgICAgXCJodHRwczovL3d3dy5lYXN5aWNvbi5uZXQvYXBpL3Jlc2l6ZUFwaS5waHA/aWQ9MTI2NjUzNiZzaXplPTEyOFwiLFxuICAgICAgICBcImh0dHBzOi8vd3d3LmVhc3lpY29uLm5ldC9hcGkvcmVzaXplQXBpLnBocD9pZD0xMjcxNjU1JnNpemU9MTI4XCIsXG4gICAgXSxcbiAgICAvLyDpmpDol4/lvIDlhbPvvIzkuI3pnIDopoHpmpDol4/or7forr7nva7kuLpmYWxzZVxuICAgIG5lZWRIaWRlUnVsZTogdHJ1ZSxcbiAgICAvLyDoh6rooYzmt7vliqDopoHpmpDol4/nmoTmoIforrDvvIzmoLzlvI/kuLrvvJpbXCJb5qCH6K6w5ZCNMV1cIu+8jFwiW+agh+iusOWQjTJdXCIuLi5dXG4gICAgaGlkZVN5bWJvbHM6IFtcIlvmqKHmnb9dXCIsIFwiW+acquWujOaIkF1cIl0sXG4gICAgLy8g5oC75LuT5bqT5pu05paw5Zyw5Z2AXG4gICAgcmVtb3RlRGVwb3RSdWxlVXJsOiBcImh0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9yYXcvbWFzdGVyL3J1bGV2ZXJzaW9uL2RlcG90UnVsZV92Ml9yZWxlYXNlLmpzb25cIixcbiAgICBzdGF0dXNDYWNoZUZpbGU6IFwiaGlrZXI6Ly9maWxlcy9cIiArIG1SdWxlLnRpdGxlICsgXCJfXCIgKyBtUnVsZS5hdXRob3IgKyBcIi5qc29uXCIsXG59O1xuLy8g6Iul5LiN5piv56ys5LiA5qyh5L2/55So5oC75LuT5bqT5YiZ6ZqQ6JeP5byA5Y+R5paH5qGjXG52YXIgZGVwb3RTdGF0dXMgPSB7XG4gICAgLy8g6Iul6ZyA6KaB5rC45LmF5pi+56S65byA5Y+R5paH5qGj77yM5YiZ5Y+W5raI5rOo6YeKXG4gICAgLy8gc2hvd0RldkRvYzogdHJ1ZSxcbiAgICAvLyDoi6XpnIDopoHmsLjkuYXmmL7npLrmj5DnpLrvvIzliJnlj5bmtojms6jph4pcbiAgICAvLyBzaG93VGlwczogdHJ1ZSxcbiAgICAvLyDoi6XpnIDopoHmsLjkuYXmmL7npLrkvovlrZDvvIzliJnlj5bmtojms6jph4pcbiAgICAvLyBzaG93RXRjOiB0cnVlXG59O1xuXG52YXIgcmVtb3RlQXV0aG9yTGlzdCA9IFtdO1xudHJ5IHtcbiAgICBldmFsKFwicmVtb3RlQXV0aG9yTGlzdD1cIiArIGZldGNoKHNldHRpbmdzLnJlbW90ZUF1dGhvckxpc3RVcmwsIHt9KSk7XG59IGNhdGNoIChlKSB7XG59XG5BcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzZXR0aW5ncy5hdXRob3JMaXN0LCByZW1vdGVBdXRob3JMaXN0KTtcbmlmIChzZXR0aW5ncy5hdXRob3JMaXN0Qm90dG9tLmxlbmd0aCAhPSAwKSBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzZXR0aW5ncy5hdXRob3JMaXN0LCBzZXR0aW5ncy5hdXRob3JMaXN0Qm90dG9tKTtcblxuLy8g5LuT5bqT54q25oCB57yT5a2Y5paH5Lu25Zyw5Z2AXG52YXIgc3RhdHVzQ2FjaGVGaWxlID0gc2V0dGluZ3Muc3RhdHVzQ2FjaGVGaWxlICE9IG51bGwgJiYgc2V0dGluZ3Muc3RhdHVzQ2FjaGVGaWxlICE9IFwiXCIgPyBzZXR0aW5ncy5zdGF0dXNDYWNoZUZpbGUgOiBcImhpa2VyOi8vZmlsZXMvXCIgKyBtUnVsZS50aXRsZSArIFwiX1wiICsgbVJ1bGUuYXV0aG9yICsgXCIuanNvblwiO1xuLy8g5Li+5L6LIGhpa2VyOi8vZmlsZXMvZGVwb3RTdGF0dXNfdjIuanNvblxucHV0VmFyKHtrZXk6ICdzdGF0dXNDYWNoZUZpbGUnLCB2YWx1ZTogc3RhdHVzQ2FjaGVGaWxlfSk7XG5cbi8vIOaKiuaAu+S7k+W6k+eKtuaAgeWGmeWFpeaWh+S7tlxuZnVuY3Rpb24gd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cykge1xuICAgIHdyaXRlRmlsZShzdGF0dXNDYWNoZUZpbGUsIEpTT04uc3RyaW5naWZ5KGRlcG90U3RhdHVzKSk7XG59XG5cbnZhciBkZXBvdFN0YXR1c0ZpbGUgPSBmZXRjaChzdGF0dXNDYWNoZUZpbGUsIHt9KTtcbmlmIChkZXBvdFN0YXR1c0ZpbGUgIT0gXCJcIikge1xuICAgIGV2YWwoXCJkZXBvdFN0YXR1cz1cIiArIGRlcG90U3RhdHVzRmlsZSk7XG59XG5cbmZ1bmN0aW9uIGlzSGlkZVJ1bGUocnVsZVRpdGxlKSB7XG4gICAgaWYgKHNldHRpbmdzLm5lZWRIaWRlUnVsZSAhPSB0cnVlKSByZXR1cm4gZmFsc2U7XG4gICAgLy8gaWYgKGhpZGVTeW1ib2xzLmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgdmFyIHJ1bGVUZW1wID0gcnVsZVRpdGxlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2V0dGluZ3MuaGlkZVN5bWJvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHJ1bGVUZW1wLmluZGV4T2Yoc2V0dGluZ3MuaGlkZVN5bWJvbHNbaV0pICE9IC0xKSByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG5kLnB1c2goe1xuICAgIHRpdGxlOiBcIuasoui/juadpeWIsOinhueVjOaAu+S7k+W6k1wiLFxuICAgIGRlc2M6IFwi5Zyo6L+Z6YeM77yM5L2g5Y+v5Lul55WF5ri45ZCE5Liq5aSn5L2s55qE6KeE5YiZ77yM5b+r6YCf5rWP6KeI5b+r6YCf5a+85YWlXCIsXG4gICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG59KTtcblxuaWYgKGRlcG90U3RhdHVzLnNob3dUaXBzICE9IGZhbHNlKSB7XG4gICAgZC5wdXNoKHtcbiAgICAgICAgdGl0bGU6IFwi6aaW5qyh5a+85YWl5o+Q56S6XFxu4oCY4oCYKOS7heaYvuS4gOasoSnigJnigJlcIixcbiAgICAgICAgZGVzYzogXCLigJjigJjkuIvmi4nliLfmlrDljbPlj6/mmL7npLrku5PlupPigJnigJlcIiArIFwiXFxu6KeE5YiZ6YeM5pyJ5aW95aSa6ZqQ6JeP55qE5byA5YWz5ZOm77yBXCIgKyBcIlxcbuKAmOKAmOaPkOS+m+eahOS+i+WtkOS5n+S7heaYvuS4gOasoeKAmeKAmVwiLFxuICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICB9KTtcbiAgICBkZXBvdFN0YXR1cy5zaG93VGlwcyA9IGZhbHNlO1xuICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpO1xufSBlbHNlIHtcblxuICAgIGlmIChkZXBvdFN0YXR1cy5zaG93RXRjICE9IGZhbHNlIHx8IG1SdWxlLnZlcnNpb24gIT0gZGVwb3RTdGF0dXMudmVyc2lvbikge1xuICAgICAgICBkZXBvdFN0YXR1cy5zaG93RXRjID0gZmFsc2U7XG4gICAgICAgIGRlcG90U3RhdHVzLnZlcnNpb24gPSBtUnVsZS52ZXJzaW9uO1xuICAgICAgICB3cml0ZURlcG90U3RhdHVzVG9GaWxlKGRlcG90U3RhdHVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzZXR0aW5ncy5oaWRlU3ltYm9scy5wdXNoKFwiW+S+i+WtkF1cIik7XG4gICAgfVxuXG4gICAgaWYgKGRlcG90U3RhdHVzLnNob3dEZXZEb2MgIT0gZmFsc2UpIHtcbiAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIuOAkOWkp+S9rOmAmumBk+OAkVxcbuKAmOKAmCjku4XmmL7kuIDmrKEp4oCZ4oCZXCIsXG4gICAgICAgICAgICBkZXNjOiBcIuKAmOKAmOeCueWHu+afpeeci1Yy5oC75LuT5bqT5byA5Y+R5paH5qGj4oCZ4oCZXFxu6KeE5YiZ6YeM5pyJ5rC45LmF5pi+56S65byA5YWz5Y+v5Lul6Ieq5bex5Y675byAXCIsXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly9naXRlZS5jb20vUmVib3JuXzAvSGlrZXJSdWxlc0RlcG90L2Jsb2IvbWFzdGVyL1JFQURNRS5tZCNkb2N1bWVudD1odHRwczovL2dpdGVlLmNvbS9SZWJvcm5fMC9IaWtlclJ1bGVzRGVwb3QvYmxvYi9tYXN0ZXIvUkVBRE1FLm1kXCIsXG4gICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGRlcG90U3RhdHVzLnNob3dEZXZEb2MgPSBmYWxzZTtcbiAgICAgICAgd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cyk7XG4gICAgfVxuXG4gICAgdmFyIGRlc2MgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICByZXR1cm4gcnVsZS5vbGRWZXJzaW9uICE9IG51bGwgJiYgcnVsZS5vbGRWZXJzaW9uIDwgcnVsZS52ZXJzaW9uID8gKFwi4oCY4oCY5pyJ5paw54mI5pys77yaXCIgKyBydWxlLnZlcnNpb24gKyBcIuKAmeKAme+8jOeCueWHu+WvvOWFpeaWsOeJiOacrFwiKSA6IHJ1bGUub2xkVmVyc2lvbiA+IHJ1bGUudmVyc2lvbiA/IFwi4oCY4oCY5Za177yf5Li65ZWl5L2g55qE6KeE5YiZ54mI5pys5q+U5oiR6L+Y6auY77yf4oCZ4oCZXCIgOiBcIuW9k+WJjeinhOWImeW3suaYr+acgOaWsOeJiO+8jOeCueWHu+i3s+WIsOinhOWImemhtVwiO1xuICAgIH07XG5cbiAgICAvLyDkuLrmiYDmnInliIbnsbvmt7vliqDmgLvku5PlupPpoblcbiAgICB0cnkge1xuICAgICAgICB2YXIgcmVtb3RlRGVwb3RSdWxlID0ge307XG4gICAgICAgIGV2YWwoXCJyZW1vdGVEZXBvdFJ1bGU9XCIgKyBmZXRjaChzZXR0aW5ncy5yZW1vdGVEZXBvdFJ1bGVVcmwsIHt9KSk7XG4gICAgICAgIHZhciBsb2NhbERlcG90UnVsZSA9IEpTT04ucGFyc2UoZ2V0UnVsZSgpKTtcbiAgICAgICAgcmVtb3RlRGVwb3RSdWxlLm9sZFZlcnNpb24gPSBsb2NhbERlcG90UnVsZS52ZXJzaW9uO1xuICAgICAgICAvL3NldEVycm9yKEpTT04uc3RyaW5naWZ5KGxvY2FsRGVwb3RSdWxlKSk7XG4gICAgICAgIC8vc2V0RXJyb3IoSlNPTi5zdHJpbmdpZnkocmVtb3RlRGVwb3RSdWxlKSk7XG4gICAgICAgIGlmIChyZW1vdGVEZXBvdFJ1bGUub2xkVmVyc2lvbiA8IHJlbW90ZURlcG90UnVsZS52ZXJzaW9uKSB7XG4gICAgICAgICAgICBkLnB1c2goe1xuICAgICAgICAgICAgICAgIHRpdGxlOiByZW1vdGVEZXBvdFJ1bGUudGl0bGUgKyBcIlxcdFwiICsgZGVzYyhyZW1vdGVEZXBvdFJ1bGUpLFxuICAgICAgICAgICAgICAgIHVybDogXCJodHRwczovL2JhaWR1LmNvbSNcIiArIEpTT04uc3RyaW5naWZ5KHJlbW90ZURlcG90UnVsZSkgfHwgXCJcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCIsXG4gICAgICAgICAgICAgICAgZGVzYzogXCLjgJDmm7TmlrDml6Xlv5fjgJFcXG7mm7TlpJrlrozmlbTml6Xlv5for7flnKjph4zpnaLngrnlh7vov5vlhaXljp/nvZHpobXmn6XnnItcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkWzBdLmRlc2MgPSBcIuKAmOKAmOeCueWHu+WPr+afpeeci+abtOaWsOaXpeW/l+KAmeKAmTxicj5cIiArIGRbMF0uZGVzYztcbiAgICAgICAgICAgIGRbMF0udXJsID0gXCJodHRwczovL2dpdGVlLmNvbS9xaXVzdW5zaGluZTIzMy9oaWtlclZpZXcvYmxvYi9tYXN0ZXIvcnVsZXZlcnNpb24vQ0hBTkdFTE9HX0RFUE9UUlVMRV9WMi5tZCN1cGRhdGVUZXh0PVwiICsgcmVtb3RlRGVwb3RSdWxlLnVwZGF0ZVRleHRcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIuKAmOKAmOaAu+S7k+W6k+abtOaWsOeoi+W6j+W3suaNn+Wdj+KAmeKAmVwiLFxuICAgICAgICAgICAgZGVzYzogXCLor7fogZTns7sgXCIgKyBtUnVsZS5hdXRob3IgKyBcIiDkv67lpI1cIixcbiAgICAgICAgICAgIGNvbF90eXBlOiBcInRleHRfY2VudGVyXzFcIixcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZXR0aW5ncy5hdXRob3JMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpc0hpZGVSdWxlKHNldHRpbmdzLmF1dGhvckxpc3RbaV0pKSB7XG4gICAgICAgICAgICBzZXR0aW5ncy5hdXRob3JMaXN0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwaWNVcmwgPSBudWxsO1xuICAgICAgICB2YXIgcGljVXJsSlMgPSBzZXR0aW5ncy5hdXRob3JMaXN0W2ldLm1hdGNoKC9waWNVcmw9LltcXHNcXFNdKj8nLykgKyBcIjtcIjtcbiAgICAgICAgZXZhbChwaWNVcmxKUyk7XG4gICAgICAgIGlmIChwaWNVcmwgPT0gbnVsbCkgcGljVXJsID0gc2V0dGluZ3MucGljVXJsTGlzdFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzZXR0aW5ncy5waWNVcmxMaXN0Lmxlbmd0aCldO1xuICAgICAgICAvLyBzZXRFcnJvcihwaWNVcmwpXG4gICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogc2V0dGluZ3MuYXV0aG9yTGlzdFtpXS5zcGxpdChcIkBAXCIpWzBdLFxuICAgICAgICAgICAgdXJsOiBcImh0dHBzOi8vYmFpZHUuY29tI1wiICsgc2V0dGluZ3MuYXV0aG9yTGlzdFtpXSxcbiAgICAgICAgICAgIHBpY191cmw6IHBpY1VybFxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIHNldEVycm9yKEpTT04uc3RyaW5naWZ5KGQpKTtcbnJlcy5kYXRhID0gZDtcbnNldEhvbWVSZXN1bHQocmVzKTsiLCJzZWFyY2hfdXJsIjoiIiwidGl0bGVDb2xvciI6IiNmZmYyMGMwMCIsImdyb3VwIjoiI++4j+KDo+mmlumhtSIsInNlYXJjaEZpbmQiOiIiLCJkZXRhaWxfY29sX3R5cGUiOiJ0ZXh0XzEiLCJkZXRhaWxfZmluZF9ydWxlIjoianM6XG52YXIgcmVzID0ge307XG52YXIgZCA9IFtdO1xuXG4vLyDku5PlupPkuKrmgKforr7nva5cbnZhciBzZXR0aW5ncyA9IHtcbiAgICAvLyDorr7nva4gdHJ1ZSDkuIDplK7lh4DljJbvvIzpmaTkuobop4TliJnlkozku5PlupPpgJrnn6XvvIzllaXkuZ/kuI3opoFcbiAgICBoaWRlQWxsOiBmYWxzZSxcbiAgICAvLyDlsI/ku5PlupPmoIfpopjlvIDlhbPvvIjms6jmhI/kuovpobnkuIrpnaLpgqPkuKrvvInvvIzkuI3pnIDopoHmmL7npLror7forr7nva7kuLp0cnVlXG4gICAgbm9UaXRsZTogdHJ1ZSxcbiAgICAvLyDms6jmhI/kuovpobnlvIDlhbPvvIzkuI3pnIDopoHmmL7npLror7forr7nva7kuLp0cnVlXG4gICAgbm9XYXJuaW5nOiBmYWxzZSxcbiAgICAvLyDop4TliJnmlbDph4/mmL7npLrlvIDlhbPvvIzkuI3pnIDopoHmmL7npLror7forr7nva7kuLp0cnVlXG4gICAgbm9SdWxlc051bTogZmFsc2UsXG4gICAgLy8g5piv5ZCm5YWB6K646LaF6L+H5LiA5a6a6KeE5YiZ5pWw5ZCO5pS55Y+Y5pi+56S65qC35byP77yM6buY6K6k5LiN5byA5ZCvXG4gICAgbmVlZENoYW5nZVNob3dUeXBlOiBmYWxzZSxcbiAgICAvLyDorr7nva7mnIDlpKfmmL7npLrlrozmlbTmlofmnKznmoTop4TliJnmlbDvvIzlpKfkuo7orr7nva7lgLzliJnmmL7npLrkuLrmjInpkq7moLflvI8o6buY6K6kIHRleHRfMilcbiAgICBzaG93RnVsbFRleHRNYXg6IDEwLFxuICAgIC8vIOiuvue9rui2hei/h+WFgeiuuOaYvuekuuWujOaVtOaWh+acrOeahOinhOWImeaVsOWQjuaYvuekuueahOagt+W8j1xuICAgIG92ZXJNYXhTaG93VHlwZTogXCJ0ZXh0XzJcIixcbiAgICAvKipcbiAgICAgKiDop4TliJnmmKDlsITliJfooahcbiAgICAgKiDlt6bmnKzlnLDvvIzlj7Pov5znq6/vvIzmnKzlnLDmmKDlsITkuLrov5znq6/vvIzovr7liLDmm7/mjaLlhoXlrrnnmoTnm67nmoRcbiAgICAgKiDvvIjms6jmhI/vvIznqIvluo/pgLvovpHkuLrlhYjmmKDlsITlkI7miafooYzkuIvpnaLnmoTliKDpmaTmoIforrDvvIlcbiAgICAgKi9cbiAgICBydWxlc01hcHBpbmc6IFtcbiAgICAgICAgLy8gW3tcInRpdGxlXCI6IFwi6aKE5ZGK54mH4oCiVFwiLCBcImF1dGhvclwiOiBcIlJlYm9yblwifSwge1widGl0bGVcIjogXCLpooTlkYrniYfigKJSZVwiLCBcImF1dGhvclwiOiBcIlJlYm9yblwifV0sXG4gICAgICAgIC8vIFt7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAolQpXCIsIFwiYXV0aG9yXCI6IFwiUmVib3JuXCJ9LCB7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAolJlKVwiLCBcImF1dGhvclwiOiBcIlJlYm9yblwifV0sXG4gICAgICAgIC8vIFt7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAokIpXCIsIFwiYXV0aG9yXCI6IFwiUmVib3JuXCJ9LCB7XCJ0aXRsZVwiOiBcIi4qPyg/PeKAolJlKVwiLCBcImF1dGhvclwiOiBcIlJlYm9yblwifV1cbiAgICBdLFxuICAgIC8vIOS6keerr+inhOWImeaYoOWwhOWIl+ihqOmTvuaOpe+8jOWGheWuueagvOW8j+aYr0pTT07mlbDnu4TvvIzor7foh6rlt7Horr7nva5cbiAgICByZW1vdGVSdWxlc01hcHBpbmdVcmw6IFwiXCIsXG4gICAgLy8g5YWl5oiP5byA5YWz77yf77yI5ruR56i977yJLy8g5Yig6Zmk5byA5YWz77yM5LiN6ZyA6KaB5Yig6Zmk6K+36K6+572u5Li6ZmFsc2VcbiAgICBuZWVkRGVsU3ltYm9sOiB0cnVlLFxuICAgIC8vIOiHquihjOa3u+WKoOimgeiiq+WIoOaOieeahOagh+iusFxuICAgIHN5bWJvbHM6IFtcIuagh+iusDFcIiwgXCLmoIforrAyXCJdLFxuICAgIC8vIOmakOiXj+W8gOWFs++8jOS4jemcgOimgemakOiXj+ivt+iuvue9ruS4umZhbHNlXG4gICAgbmVlZEhpZGVSdWxlOiB0cnVlLFxuICAgIC8vIOiHquihjOa3u+WKoOimgemakOiXj+eahOagh+iusO+8jOagvOW8j+S4uu+8mlvmoIforrDlkI1dXG4gICAgaGlkZVN5bWJvbHM6IFtcIlvmqKHmnb9dXCIsIFwiW+acquWujOaIkF1cIl0sXG4gICAgLy8g5piv5ZCm6ZqQ6JeP5L6L5a2Q77yM6ZyA6KaB6ZqQ6JeP6K+36K6+572u5Li6dHJ1ZVxuICAgIG5lZWRIaWRlRXRjOiBmYWxzZSxcblxuICAgIC8vIOiLpemcgOimgeWFs+mXreW/veeVpeacrOasoeabtOaWsOivt+iuvue9ruS4unRydWVcbiAgICBub0lnbm9yZVVwZGF0ZTogZmFsc2UsXG4gICAgLy8g5pys5Zyw5b+955Wl5pu05paw5YiX6KGo77yMXG4gICAgLy8g5YaF5a655qih5p2/5Li6IHt0aXRsZTogXCLop4TliJnlkI1cIiwgYXV0aG9yOiBcIuinhOWImeS9nOiAhVwifVxuICAgIGlnbm9yZVVwZGF0ZVJ1bGVMaXN0OiBbXG4gICAgICAgIC8vIHt0aXRsZTogXCLpooTlkYrniYfigKJSZVwiLCBhdXRob3I6IFwiUmVib3JuXCJ9LFxuICAgIF0sXG4gICAgLy8g5LqR56uv5b+955Wl5pu05paw5YiX6KGo6ZO+5o6l77yM5qC85byP5pivSlNPTuaVsOe7hO+8jOivt+iHquW3seiuvue9rlxuICAgIHJlbW90ZUlnbm9yZUxpc3RVcmw6IFwiXCIsXG4gICAgLy8g5Y+C6ICD6ZO+5o6l77yaXG4gICAgLy8gaHR0cHM6Ly9naXRlZS5jb20vUmVib3JuXzAvSGlrZXJSdWxlc0RlcG90L3Jhdy9tYXN0ZXIvaWdub3JlVXBkYXRlUnVsZUxpc3QuanNvblxuICAgIC8vIGh0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9yYXcvbWFzdGVyL3J1bGV2ZXJzaW9uL1JlYm9ybi9pZ25vcmVVcGRhdGVSdWxlTGlzdC5qc29uXG5cbiAgICAvLyDms6jmhI/kuovpobnmloflrZdcbiAgICB3YXJpbmdUZXh0OiBcIjEuIOS/neWtmOWQjumcgOimgeaJi+WKqOS4i+aLieWIt+aWsOaJjeiDveabtOaWsOinhOWImeeKtuaAgVwiICsgXCJcXG4yLiDmjInpkq7lvaLnirbnmoTop4TliJnmmK/lpITkuo7mnIDmlrDniYjmnKznmoTvvIzngrnlh7vlj6/ot7Povazoh7Pop4TliJnpobVcIixcbiAgICAvLyDpppbmrKHlr7zlhaXmloflrZdcbiAgICBmaXJzdEltcG9ydFRleHQ6IFwiMS7igJjigJjkuIvmi4nliLfmlrDljbPlj6/mmL7npLrku5PlupPop4TliJnigJnigJlcIiArIFwiXFxuMi7kuoznuqfop4TliJnkuK0gbmVlZENoYW5nZVNob3dUeXBlIOWPr+iuvue9ruaYvuekuuagt+W8j1wiICsgXCJcXG4zLuS6jOe6p+inhOWImeS4rSBoaWRlQWxsIOWPr+iuvue9ruS4gOmUrumakOiXj+agh+mimOWSjOazqOaEj+S6i+mhuVwiLFxuICAgIHN0YXR1c0NhY2hlRmlsZTogZ2V0VmFyKCdzdGF0dXNDYWNoZUZpbGUnKSxcbn07XG4vLyDoi6XkuI3mmK/nrKzkuIDmrKHkvb/nlKjmgLvku5PlupPliJnlrZjlgqjku5PlupPnirbmgIFcbnZhciBkZXBvdFN0YXR1cyA9IHt9O1xuXG5pZiAoc2V0dGluZ3MubmVlZEhpZGVFdGMgPT0gdHJ1ZSkgc2V0dGluZ3MuaGlkZVN5bWJvbHMucHVzaChcIlvkvovlrZBdXCIpO1xuXG4vLyDku5PlupPnirbmgIHnvJPlrZjmlofku7blnLDlnYBcbmlmIChzZXR0aW5ncy5zdGF0dXNDYWNoZUZpbGUgPT0gbnVsbCB8fCBzZXR0aW5ncy5zdGF0dXNDYWNoZUZpbGUgPT0gXCJcIikgc2V0dGluZ3Muc3RhdHVzQ2FjaGVGaWxlID0gXCJoaWtlcjovL2ZpbGVzL2RlcG90U3RhdHVzX3YyLmpzb25cIjtcbi8vIOS4vuS+iyBoaWtlcjovL2ZpbGVzL2RlcG90U3RhdHVzX3YyLmpzb25cbi8vIHNldEVycm9yKHN0YXR1c0NhY2hlRmlsZSk7XG5cbnZhciByZW1vdGVJZ25vcmVMaXN0ID0gW107XG50cnkge1xuICAgIGV2YWwoXCJyZW1vdGVJZ25vcmVMaXN0PVwiICsgZmV0Y2goc2V0dGluZ3MucmVtb3RlSWdub3JlTGlzdFVybCwge30pKTtcbn0gY2F0Y2ggKGUpIHtcbn1cbkFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHNldHRpbmdzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0LCByZW1vdGVJZ25vcmVMaXN0KTtcbi8vIHNldEVycm9yKEpTT04uc3RyaW5naWZ5KHJlbW90ZUlnbm9yZUxpc3QpKTtcblxuXG52YXIgcmVtb3RlUnVsZXNNYXBwaW5nID0gW107XG50cnkge1xuICAgIGV2YWwoXCJyZW1vdGVSdWxlc01hcHBpbmc9XCIgKyBmZXRjaChzZXR0aW5ncy5yZW1vdGVSdWxlc01hcHBpbmdVcmwsIHt9KSk7XG59IGNhdGNoIChlKSB7XG59XG5BcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzZXR0aW5ncy5ydWxlc01hcHBpbmcsIHJlbW90ZVJ1bGVzTWFwcGluZyk7XG4vLyBzZXRFcnJvcihKU09OLnN0cmluZ2lmeShydWxlc01hcHBpbmcpKTtcblxuXG4vKipcbiAqIOWPr+WcqOatpOWkhOiHquWumuS5ieS7k+W6k++8jOWunueOsOengeS6uuS7k+W6k1xuICpcbiAqIOS7pVJlYm9ybuS7k+W6k+eahOmTvuaOpeS4uuWPguiAg1xuICpcbiAqIGh0dHBzOi8vZ2l0ZWUuY29tL1JlYm9ybl8wL0hpa2VyUnVsZXNEZXBvdC9ibG9iL21hc3Rlci91cGRhdGUuanNvblxuICovXG52YXIgYXV0aG9yTGlzdCA9IGdldFVybCgpLnNwbGl0KFwiI1wiKVsxXTtcbnZhciBhdXRob3JBbmRPd25lckFuZFByb2plY3QgPSBhdXRob3JMaXN0LnNwbGl0KFwiQEBcIik7XG52YXIgYXV0aG9yID0gYXV0aG9yQW5kT3duZXJBbmRQcm9qZWN0WzBdO1xudmFyIHJlbW90ZVVybCA9IFwiXCI7XG5cbnZhciBhcGlUeXBlID0gXCIxXCI7ICAvLyAwIOS4uuaWh+S7tuebtOmTvu+8jDEg5Li656CB5LqRQVBJXG52YXIgYXBpVHlwZUpTID0gYXV0aG9yTGlzdC5tYXRjaCgvYXBpVHlwZT0uW1xcc1xcU10qPycvKSArIFwiO1wiO1xuZXZhbChhcGlUeXBlSlMpO1xuaWYgKGFwaVR5cGUgPT0gbnVsbCkgYXBpVHlwZSA9IFwiMVwiO1xuXG5pZiAoYXBpVHlwZSA9PSBcIjBcIikge1xuICAgIHZhciBmdWxsVXJsID0gXCJcIjtcbiAgICB2YXIgZnVsbFVybEpTID0gYXV0aG9yTGlzdC5tYXRjaCgvZnVsbFVybD0uW1xcc1xcU10qPycvKSArIFwiO1wiO1xuICAgIGV2YWwoZnVsbFVybEpTKTtcbiAgICByZW1vdGVVcmwgPSBmdWxsVXJsO1xufSBlbHNlIGlmIChhcGlUeXBlID09IFwiMVwiKSB7XG4gICAgdmFyIHJlbW90ZUFwaUhvbWUgPSBcImh0dHBzOi8vZ2l0ZWUuY29tL2FwaS92NS9yZXBvcy9cIjtcbiAgICB2YXIgb3duZXIgPSBhdXRob3JBbmRPd25lckFuZFByb2plY3RbMV07ICAgLy8g5LuT5bqT5oul5pyJ6ICFXG4gICAgdmFyIHJlcG8gPSBhdXRob3JBbmRPd25lckFuZFByb2plY3RbMl07IC8vIOS7k+W6k+WQjVxuICAgIHZhciByZW1vdGVGaWxlbmFtZSA9IG51bGw7IC8vIOaWh+S7tuWQjVxuICAgIHZhciBwYXRoID0gcmVtb3RlRmlsZW5hbWU7ICAvLyDlnKjku5PlupPkuK3mlofku7bnmoTot6/lvoRcbiAgICB2YXIgYWNjZXNzX3Rva2VuID0gbnVsbDsgIC8vIOeUqOaIt+aOiOadg+egge+8jOWcqOeggeS6kVwi6K6+572u4oCUPuWuieWFqOiuvuWumi0+5Liq5Lq66K6/6Zeu5Luk54mMXCLkuK3lj6/ku6XnlJ/miJBcbiAgICB2YXIgdG9rZW5KUyA9IGF1dGhvckxpc3QubWF0Y2goL2FjY2Vzc190b2tlbj0uW1xcc1xcU10qPycvKSArIFwiO1wiO1xuICAgIGV2YWwodG9rZW5KUyk7XG4gICAgLy8gc2V0RXJyb3IoYWNjZXNzX3Rva2VuPT1udWxsKTtcbiAgICB2YXIgcmVtb3RlRmlsZW5hbWVKUyA9IGF1dGhvckxpc3QubWF0Y2goL3JlbW90ZUZpbGVuYW1lPS5bXFxzXFxTXSo/Jy8pICsgXCI7XCI7XG4gICAgZXZhbChyZW1vdGVGaWxlbmFtZUpTKTtcbiAgICBpZiAocmVtb3RlRmlsZW5hbWUgPT0gbnVsbCkge1xuICAgIH1cbiAgICByZW1vdGVGaWxlbmFtZSA9IFwidXBkYXRlLmpzb25cIjtcbiAgICBwYXRoID0gcmVtb3RlRmlsZW5hbWU7XG4gICAgLy8gc2V0RXJyb3IocmVtb3RlRmlsZW5hbWUpXG4gICAgLy8gQVBJ6ZO+5o6l5Y+C6ICD77yaaHR0cHM6Ly9naXRlZS5jb20vYXBpL3Y1L3JlcG9zL3t7b3duZXJ9fS97e3JlcG99fS9jb250ZW50cy97e3BhdGh9fT9hY2Nlc3NfdG9rZW49KioqKlxuICAgIHJlbW90ZVVybCA9IHJlbW90ZUFwaUhvbWUgKyBvd25lciArIFwiL1wiICsgcmVwbyArIFwiL2NvbnRlbnRzL1wiICsgcGF0aDtcbiAgICBpZiAoYWNjZXNzX3Rva2VuICE9IG51bGwpIHtcbiAgICAgICAgcmVtb3RlVXJsID0gcmVtb3RlVXJsICsgXCI/YWNjZXNzX3Rva2VuPVwiICsgYWNjZXNzX3Rva2VuO1xuICAgIH1cbiAgICAvLyBzZXRFcnJvcihyZW1vdGVVcmwpO1xuICAgIC8vIHZhciByZW1vdGVIb21lID0gXCJodHRwczovL2dpdGVlLmNvbS9cIiArIG93bmVyICsgXCIvXCIgKyByZXBvICsgXCIvYmxvYi9tYXN0ZXIvdXBkYXRlLmpzb25cIjtcbn1cblxuLy8g5oqK5oC75LuT5bqT54q25oCB5YaZ5YWl5paH5Lu2XG5mdW5jdGlvbiB3cml0ZURlcG90U3RhdHVzVG9GaWxlKGRlcG90U3RhdHVzKSB7XG4gICAgd3JpdGVGaWxlKHNldHRpbmdzLnN0YXR1c0NhY2hlRmlsZSwgSlNPTi5zdHJpbmdpZnkoZGVwb3RTdGF0dXMpKTtcbn1cblxudmFyIGRlcG90U3RhdHVzRmlsZSA9IGZldGNoKHNldHRpbmdzLnN0YXR1c0NhY2hlRmlsZSwge30pO1xuaWYgKGRlcG90U3RhdHVzRmlsZSAhPSBcIlwiKSB7XG4gICAgZXZhbChcImRlcG90U3RhdHVzPVwiICsgZGVwb3RTdGF0dXNGaWxlKTtcbn1cbi8vIOiLpemcgOimgeawuOS5heaYvuekuuaPkOekuu+8jOWImeWPlua2iOazqOmHilxuLy8gZGVwb3RTdGF0dXMuc2hvd1NlY29uZExpc3RUaXBzID0gdHJ1ZTtcblxuaWYgKGdldFVybCgpLmluZGV4T2YoXCJydWxlOi8vXCIpICE9IC0xKSB7XG4gICAgdmFyIHJlbW90ZURlcG90UnVsZSA9IEpTT04ucGFyc2UoZ2V0VXJsKCkuc3BsaXQoXCIjXCIpWzFdKTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLmm7TmlrDml6Xlv5cgKOeCueWHu+WPr+afpeeci+WujOaVtOaXpeW/lylcIixcbiAgICAgICAgZGVzYzogcmVtb3RlRGVwb3RSdWxlLnVwZGF0ZVRleHQsXG4gICAgICAgIHVybDogXCJodHRwczovL2dpdGVlLmNvbS9xaXVzdW5zaGluZTIzMy9oaWtlclZpZXcvYmxvYi9tYXN0ZXIvcnVsZXZlcnNpb24vQ0hBTkdFTE9HX0RFUE9UUlVMRV9WMi5tZFwiLFxuICAgICAgICBjb2xfdHlwZTogXCJwaWNfMVwiXG4gICAgfSk7XG4gICAgZC5wdXNoKHtcbiAgICAgICAgdGl0bGU6IFwi54K55Ye75pu05paw5oC75LuT5bqTXCIsXG4gICAgICAgIHVybDogcmVtb3RlRGVwb3RSdWxlLnJ1bGUsXG4gICAgICAgIGNvbF90eXBlOiBcInRleHRfY2VudGVyXzFcIlxuICAgIH0pO1xufSBlbHNlIGlmIChnZXRVcmwoKS5pbmRleE9mKFwidXBkYXRlVGV4dD1cIikgIT0gLTEpIHtcbiAgICB2YXIgdXBkYXRlVGV4dCA9IG51bGw7XG4gICAgLy8gdXBkYXRlVGV4dEpTID0gXCJ1cGRhdGVUZXh0PSdcIiArIGdldFVybCgpLnNwbGl0KFwiI1wiKVsxXS5yZXBsYWNlKFwidXBkYXRlVGV4dD1cIiwgXCJcIikgKyBcIic7XCI7XG4gICAgLy8gZXZhbCh1cGRhdGVUZXh0SlMpO1xuICAgIHVwZGF0ZVRleHQgPSBnZXRVcmwoKS5zcGxpdChcIiNcIilbMV0ucmVwbGFjZShcInVwZGF0ZVRleHQ9XCIsIFwiXCIpO1xuICAgIGQucHVzaCh7XG4gICAgICAgIHRpdGxlOiBcIuabtOaWsOaXpeW/lyAo54K55Ye75Y+v5p+l55yL5a6M5pW05pel5b+XKVwiLFxuICAgICAgICBkZXNjOiB1cGRhdGVUZXh0ICE9IG51bGwgPyB1cGRhdGVUZXh0IDogXCLmmoLml6Dmm7TmlrDml6Xlv5dcIixcbiAgICAgICAgdXJsOiBcImh0dHBzOi8vZ2l0ZWUuY29tL3FpdXN1bnNoaW5lMjMzL2hpa2VyVmlldy9ibG9iL21hc3Rlci9ydWxldmVyc2lvbi9DSEFOR0VMT0dfREVQT1RSVUxFX1YyLm1kXCIsXG4gICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICB9KTtcbn0gZWxzZSBpZiAoZ2V0VXJsKCkuaW5kZXhPZihcImRvY3VtZW50PVwiKSAhPSAtMSkge1xuICAgIHZhciBkb2N1bWVudFVybCA9IG51bGw7XG4gICAgZG9jdW1lbnRVcmwgPSBnZXRVcmwoKS5zcGxpdChcIiNcIilbMV0ucmVwbGFjZShcImRvY3VtZW50PVwiLCBcIlwiKTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLmgLvku5PlupPlvIDlj5HmlofmoaPlhaXlj6NcIixcbiAgICAgICAgZGVzYzogXCLov5nmmK/kuJPpl6jnu5nlpKfkvazku6zlhpnnmoTvvIzmlofnrJTlpKrlt67kuobvvIzop4nlvpflhpnlvpfkubHov5jor7fkvZPosIXkuIDkuIvwn5mI44CC5pyJ5LiN5oeC55qE5Zyw5pa55Y+v5Lul6IGU57O75oiR77yM5rqc5LqG5rqc5LqG772eXCIsXG4gICAgICAgIHVybDogZG9jdW1lbnRVcmwsXG4gICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICB9KTtcbiAgICBkLnB1c2goe1xuICAgICAgICB0aXRsZTogXCLngrnlh7vlj6/mn6XnnIvlrozmlbTmlofmoaNcIixcbiAgICAgICAgdXJsOiBkb2N1bWVudFVybCxcbiAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgfSk7XG59IGVsc2Uge1xuXG4gICAgZnVuY3Rpb24gZ2V0UnVsZU5vU3ltYm9scyhydWxlLCBzeW1ib2xMaXN0KSB7XG4gICAgICAgIGlmIChzZXR0aW5ncy5uZWVkRGVsU3ltYm9sICE9IHRydWUpIHJldHVybiBydWxlO1xuICAgICAgICB2YXIgcnVsZVRlbXAgPSBydWxlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN5bWJvbExpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzeW1ib2xSZWcgPSBuZXcgUmVnRXhwKHN5bWJvbExpc3RbaV0sIFwiZ1wiKTtcbiAgICAgICAgICAgIHJ1bGVUZW1wLnRpdGxlID0gcnVsZVRlbXAudGl0bGUucmVwbGFjZShzeW1ib2xSZWcsIFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vc2V0RXJyb3IoSlNPTi5zdHJpbmdpZnkocnVsZVRlbXApKTtcbiAgICAgICAgcmV0dXJuIHJ1bGVUZW1wO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSGlkZVJ1bGUocnVsZSkge1xuICAgICAgICBpZiAoc2V0dGluZ3MubmVlZEhpZGVSdWxlICE9IHRydWUpIHJldHVybiBmYWxzZTtcbiAgICAgICAgLy8gaWYgKGhpZGVTeW1ib2xzLmxlbmd0aCA9PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHZhciBydWxlVGVtcCA9IHJ1bGU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2V0dGluZ3MuaGlkZVN5bWJvbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChydWxlVGVtcC50aXRsZS5pbmRleE9mKHNldHRpbmdzLmhpZGVTeW1ib2xzW2ldKSAhPSAtMSkgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIOWmguaenOacrOWcsOayoeacieWImeaPkOekuuWvvOWFpeaWsOinhOWImVxuICAgIC8vIOWboOmDqOWIhuaJi+acuuS4jeaUr+aMgWVzNuivreazle+8jOaVheazqOmHiuaOiVxuICAgIC8qdmFyIG15UnVsZXNNYXAgPSBuZXcgTWFwKCk7XG4gICAgbXlSdWxlcy5tYXAocnVsZSA9PiB7XG4gICAgICAgIG15UnVsZXNNYXAuc2V0KHJ1bGUudGl0bGUsIHRydWUpO1xuICAgIH0pO1xuICAgIC8vc2V0RXJyb3IobXlSdWxlc01hcC5nZXQoXCLohb7orq/igKJSZVwiKSk7Ki9cblxuICAgIGZ1bmN0aW9uIGdldFJ1bGVJbkFycmF5KHJ1bGVzLCBydWxlKSB7XG4gICAgICAgIGlmIChydWxlcyA9PSBudWxsIHx8IHJ1bGVzLmxlbmd0aCA9PSAwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHJ1bGVzW2ldLnRpdGxlID09IHJ1bGUudGl0bGUgJiYgcnVsZXNbaV0uYXV0aG9yID09IGF1dGhvcikgcmV0dXJuIHJ1bGVzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIOWOn+Wni+aWueazle+8jOavlOi+g+iAl+aXtlxuICAgIGZ1bmN0aW9uIGlzSW5BcnJheShydWxlcywgcnVsZSkge1xuICAgICAgICBpZiAoZ2V0UnVsZUluQXJyYXkocnVsZXMsIHJ1bGUpICE9IG51bGwpIHJldHVybiB0cnVlO1xuICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0lnbm9yZVVwZGF0ZVJ1bGUocnVsZSkge1xuICAgICAgICBpZiAoaXNJbkFycmF5KHNldHRpbmdzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0LCBydWxlKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICB2YXIgY2FjaGVJZ25vcmVSdWxlID0gZ2V0UnVsZUluQXJyYXkoZGVwb3RTdGF0dXMuaWdub3JlVXBkYXRlUnVsZUxpc3QsIHJ1bGUpO1xuICAgICAgICAgICAgaWYgKGNhY2hlSWdub3JlUnVsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRlcG90U3RhdHVzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0ID09IG51bGwpIGRlcG90U3RhdHVzLmlnbm9yZVVwZGF0ZVJ1bGVMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgY2FjaGVJZ25vcmVSdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogcnVsZS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiBhdXRob3IsXG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246IHJ1bGUudmVyc2lvblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZGVwb3RTdGF0dXMuaWdub3JlVXBkYXRlUnVsZUxpc3QucHVzaChjYWNoZUlnbm9yZVJ1bGUpO1xuICAgICAgICAgICAgICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChydWxlLnZlcnNpb24gIT0gY2FjaGVJZ25vcmVSdWxlLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVJZ25vcmVSdWxlLnZlcnNpb24gPSBydWxlLnZlcnNpb247XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlRGVwb3RTdGF0dXNUb0ZpbGUoZGVwb3RTdGF0dXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRJZ25vcmVVcGRhdGVSdWxlKHJ1bGUpIHtcbiAgICAgICAgaWYgKGlzSWdub3JlVXBkYXRlUnVsZShydWxlKSA9PSB0cnVlKSBydWxlLmlzSWdub3JlVXBkYXRlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgcnVsZXMgPSBbXTtcbiAgICBldmFsKFwicnVsZXM9XCIgKyBmZXRjaChcImhpa2VyOi8vaG9tZVwiLCB7fSkpO1xuICAgIHZhciBteVJ1bGVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcnVsZSA9IHJ1bGVzW2ldO1xuICAgICAgICBpZiAocnVsZS5hdXRob3IgPT0gYXV0aG9yKSB7XG4gICAgICAgICAgICBteVJ1bGVzLnB1c2goZ2V0UnVsZU5vU3ltYm9scyhydWxlLCBzZXR0aW5ncy5zeW1ib2xzKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBzZXRFcnJvcihKU09OLnN0cmluZ2lmeShteVJ1bGVzKSk7XG5cbiAgICBmdW5jdGlvbiBnZXRSdWxlSW5SdWxlc1dpdGhNYXBwaW5nKHJ1bGVzLCBydWxlKSB7XG4gICAgICAgIGlmIChydWxlcyA9PSBudWxsIHx8IHJ1bGVzLmxlbmd0aCA9PSAwIHx8IHJ1bGUgPT0gbnVsbCB8fCBydWxlLm1hcHBpbmdUaXRsZSA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHJ1bGVzW2ldLm1hcHBpbmdUaXRsZSAhPSBudWxsICYmIHJ1bGVzW2ldLm1hcHBpbmdUaXRsZSA9PSBydWxlLm1hcHBpbmdUaXRsZSAmJiBydWxlc1tpXS5hdXRob3IgPT0gYXV0aG9yKSByZXR1cm4gcnVsZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpIHtcbiAgICAgICAgaWYgKGdldFJ1bGVJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpICE9IG51bGwpIHJldHVybiB0cnVlO1xuICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgZGVzYyA9IGZ1bmN0aW9uIChydWxlcywgcnVsZSkge1xuICAgICAgICBpZiAoaXNJblJ1bGVzV2l0aE1hcHBpbmcocnVsZXMsIHJ1bGUpID09IHRydWUgfHwgaXNJbkFycmF5KHJ1bGVzLCBydWxlKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gcnVsZS5vbGRWZXJzaW9uICE9IG51bGwgJiYgcnVsZS5vbGRWZXJzaW9uIDwgcnVsZS52ZXJzaW9uID8gKFwi4oCY4oCY5pyJ5paw54mI5pys77yaXCIgKyBydWxlLnZlcnNpb24gKyBcIuKAmeKAme+8jOeCueWHu+WvvOWFpeaWsOeJiOacrFwiKSArIChcIjxicj48YnI+W+abtOaWsOaXpeW/l10gXCIgKyAocnVsZS51cGRhdGVUZXh0ID09IG51bGwgPyBcIuaXoFwiIDogcnVsZS51cGRhdGVUZXh0KSArIChydWxlLnRpcHMgIT0gbnVsbCAmJiBydWxlLnRpcHMgIT0gXCJcIiA/IFwiPGJyPjxicj5UaXBzOiBcIiArIHJ1bGUudGlwcyA6IFwiXCIpKSA6IHJ1bGUub2xkVmVyc2lvbiA+IHJ1bGUudmVyc2lvbiA/IFwi4oCY4oCY5Za177yf5Li65ZWl5L2g55qE6KeE5YiZ54mI5pys5q+U5oiR6L+Y6auY77yf4oCZ4oCZXCIgOiBcIuW9k+WJjeinhOWImeW3suaYr+acgOaWsOeJiO+8jOeCueWHu+i3s+WIsOinhOWImemhtVwiICsgKHJ1bGUudGlwcyAhPSBudWxsICYmIHJ1bGUudGlwcyAhPSBcIlwiID8gXCJcXG5cXG5UaXBzOiBcIiArIHJ1bGUudGlwcyA6IFwiXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwi4oCY4oCY5L2g5bCa5pyq5a+85YWl6K+l6KeE5YiZ4oCZ4oCZ77yM54K55Ye75a+85YWlXCIgKyAocnVsZS50aXBzICE9IG51bGwgJiYgcnVsZS50aXBzICE9IFwiXCIgPyBcIjxicj48YnI+VGlwczogXCIgKyBydWxlLnRpcHMgOiBcIlwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoZGVwb3RTdGF0dXMuc2hvd1NlY29uZExpc3RUaXBzICE9IGZhbHNlKSB7XG4gICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICB0aXRsZTogXCLpppbmrKHlr7zlhaXmj5DnpLpcXG7igJjigJgo5LuF5pi+5LiA5qyhKeKAmeKAmVwiLFxuICAgICAgICAgICAgZGVzYzogc2V0dGluZ3MuZmlyc3RJbXBvcnRUZXh0LFxuICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF9jZW50ZXJfMVwiXG4gICAgICAgIH0pO1xuICAgICAgICBkZXBvdFN0YXR1cy5zaG93U2Vjb25kTGlzdFRpcHMgPSBmYWxzZTtcbiAgICAgICAgd3JpdGVEZXBvdFN0YXR1c1RvRmlsZShkZXBvdFN0YXR1cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHNldHRpbmdzLm5vVGl0bGUgIT0gdHJ1ZSAmJiBzZXR0aW5ncy5oaWRlQWxsICE9IHRydWUpIHtcbiAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IFwi4oCY4oCY6L+Z6YeM5pivIFwiICsgYXV0aG9yICsgXCIg55qE6KeE5YiZ5bCP5LuT5bqT4oCZ4oCZXCIsXG4gICAgICAgICAgICAgICAgLy8gZGVzYzogXCLngrnlh7vlj6/orr/pl67op4TliJnku5PlupPmupBcIixcbiAgICAgICAgICAgICAgICAvLyB1cmw6IHJlbW90ZUhvbWUsXG4gICAgICAgICAgICAgICAgY29sX3R5cGU6IFwidGV4dF8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlbW90ZVJ1bGVzID0gW107XG4gICAgICAgIC8vIHZhciByZW1vdGVVcmwgPSByZW1vdGVBcGlIb21lICsgZW5jb2RlVVJJQ29tcG9uZW50KGF1dGhvcikgKyBcIi9cIiArIHJlbW90ZUZpbGVuYW1lO1xuICAgICAgICB2YXIgcmVtb3RlU291cmNlID0gZmV0Y2gocmVtb3RlVXJsLCB7fSk7XG4gICAgICAgIC8vIHNldEVycm9yKHJlbW90ZVVybCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBldmFsKFwicmVtb3RlU291cmNlPVwiICsgcmVtb3RlU291cmNlKTtcbiAgICAgICAgICAgIGlmIChhcGlUeXBlID09IFwiMFwiKSB7XG4gICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMgPSByZW1vdGVTb3VyY2U7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGFwaVR5cGUgPT0gXCIxXCIpIHtcbiAgICAgICAgICAgICAgICBldmFsKFwicmVtb3RlUnVsZXM9XCIgKyBiYXNlNjREZWNvZGUocmVtb3RlU291cmNlLmNvbnRlbnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1vdGVSdWxlcy5kYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbm90aWNlID0gcmVtb3RlUnVsZXMubm90aWNlO1xuICAgICAgICAgICAgICAgIGlmIChub3RpY2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChub3RpY2UpID09IFwic3RyaW5nXCIgJiYgbm90aWNlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwi5LuT5bqT6YCa55+lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogbm90aWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbF90eXBlOiBcInBpY18xXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiAobm90aWNlKSA9PSBcIm9iamVjdFwiICYmIG5vdGljZS5kZXNjICE9IG51bGwgJiYgbm90aWNlLmRlc2MgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogbm90aWNlLnRpdGxlICE9IG51bGwgJiYgbm90aWNlLnRpdGxlICE9IFwiXCIgPyBub3RpY2UudGl0bGUgOiBcIuS7k+W6k+mAmuefpVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IG5vdGljZS5kZXNjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY191cmw6IG5vdGljZS5waWNVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sX3R5cGU6IFwicGljXzFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMgPSByZW1vdGVSdWxlcy5kYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNldHRpbmdzLm5vV2FybmluZyAhPSB0cnVlICYmIHNldHRpbmdzLmhpZGVBbGwgIT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIuazqOaEj+S6i+mhuVwiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjOiBzZXR0aW5ncy53YXJpbmdUZXh0LFxuICAgICAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJwaWNfMVwiLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiaGlrZXI6Ly9ob21lQOaAu+S7k+W6k1wiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgfVxuICAgICAgICAvL3NldEVycm9yKHJlbW90ZVJ1bGVzLmxlbmd0aCk7XG4gICAgICAgIGlmIChyZW1vdGVSdWxlcy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZC5wdXNoKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCLor6Xov5znqIvku5PlupPml6DmlbDmja7vvIFcIixcbiAgICAgICAgICAgICAgICBjb2xfdHlwZTogXCJ0ZXh0X2NlbnRlcl8xXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9zZXRFcnJvcihteVJ1bGVzLmxlbmd0aCk7XG4gICAgICAgICAgICBpZiAobXlSdWxlcy5sZW5ndGggPj0gcmVtb3RlUnVsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8g5LiN55+l6YGT5Lya5LiN5Lya5pyJ6Zeu6aKYXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBteVJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmVtb3RlUnVsZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFJ1bGUgPSBteVJ1bGVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVJ1bGUgPSByZW1vdGVSdWxlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0hpZGVSdWxlKHJlbW90ZVJ1bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZXMuc3BsaWNlKGosIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGotLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNldElnbm9yZVVwZGF0ZVJ1bGUocmVtb3RlUnVsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNldHRpbmdzLnJ1bGVzTWFwcGluZy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlTWFwcGluZyA9IHNldHRpbmdzLnJ1bGVzTWFwcGluZ1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUnVsZU1hcHBpbmdUaXRsZSA9IHJ1bGVNYXBwaW5nWzBdLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGVSZWdleCA9IG5ldyBSZWdFeHAobG9jYWxSdWxlTWFwcGluZ1RpdGxlLCBcImdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUnVsZS5tYXBwaW5nVGl0bGUgPSBsb2NhbFJ1bGUudGl0bGUubWF0Y2godGl0bGVSZWdleClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVSdWxlTWFwcGluZ1RpdGxlID0gcnVsZU1hcHBpbmdbMV0udGl0bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlUmVnZXggPSBuZXcgUmVnRXhwKHJlbW90ZVJ1bGVNYXBwaW5nVGl0bGUsIFwiZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5tYXBwaW5nVGl0bGUgPSByZW1vdGVSdWxlLnRpdGxlLm1hdGNoKHRpdGxlUmVnZXgpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxSdWxlLm1hcHBpbmdUaXRsZSA9PSByZW1vdGVSdWxlLm1hcHBpbmdUaXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5sb2NhbFRpdGxlID0gbG9jYWxSdWxlLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUnVsZS5pc01hcHBlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLm9sZFZlcnNpb24gPSBsb2NhbFJ1bGUudmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhbFJ1bGUudGl0bGUgPT0gcmVtb3RlUnVsZS50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGUub2xkVmVyc2lvbiA9IGxvY2FsUnVsZS52ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3RlUnVsZXNbal0ucnVsZT1teVJ1bGVzW2ldLnJ1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9yZW1vdGVSdWxlc1tqXS5kZXNjPW15UnVsZXNbaV0uZGVzYztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbW90ZVJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZW1vdGVSdWxlID0gcmVtb3RlUnVsZXNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICgoaXNIaWRlUnVsZShyZW1vdGVSdWxlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNldElnbm9yZVVwZGF0ZVJ1bGUocmVtb3RlUnVsZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbXlSdWxlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUnVsZSA9IG15UnVsZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNldHRpbmdzLnJ1bGVzTWFwcGluZy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlTWFwcGluZyA9IHNldHRpbmdzLnJ1bGVzTWFwcGluZ1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUnVsZU1hcHBpbmdUaXRsZSA9IHJ1bGVNYXBwaW5nWzBdLnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGVSZWdleCA9IG5ldyBSZWdFeHAobG9jYWxSdWxlTWFwcGluZ1RpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxSdWxlLm1hcHBpbmdUaXRsZSA9IGxvY2FsUnVsZS50aXRsZS5tYXRjaCh0aXRsZVJlZ2V4KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW90ZVJ1bGVNYXBwaW5nVGl0bGUgPSBydWxlTWFwcGluZ1sxXS50aXRsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVSZWdleCA9IG5ldyBSZWdFeHAocmVtb3RlUnVsZU1hcHBpbmdUaXRsZSwgXCJnXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLm1hcHBpbmdUaXRsZSA9IHJlbW90ZVJ1bGUudGl0bGUubWF0Y2godGl0bGVSZWdleClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NhbFJ1bGUubWFwcGluZ1RpdGxlID09IHJlbW90ZVJ1bGUubWFwcGluZ1RpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLmxvY2FsVGl0bGUgPSBsb2NhbFJ1bGUudGl0bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLmlzTWFwcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVJ1bGUub2xkVmVyc2lvbiA9IGxvY2FsUnVsZS52ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxSdWxlLnRpdGxlID09IHJlbW90ZVJ1bGUudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVSdWxlLm9sZFZlcnNpb24gPSBsb2NhbFJ1bGUudmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JlbW90ZVJ1bGVzW2ldLnJ1bGU9bXlSdWxlc1tqXS5ydWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVtb3RlUnVsZXNbaV0uZGVzYz1teVJ1bGVzW2pdLmRlc2M7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gbWVyZ2VTb3J0KGFycikge1xuICAgICAgICAgICAgICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChsZW4gPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcnI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBtaWRkbGUgPSBNYXRoLmZsb29yKGxlbiAvIDIpLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gYXJyLnNsaWNlKDAsIG1pZGRsZSksXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0gYXJyLnNsaWNlKG1pZGRsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lcmdlKG1lcmdlU29ydChsZWZ0KSwgbWVyZ2VTb3J0KHJpZ2h0KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1lcmdlKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBpZ25vcmVVcGRhdGVMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGlzVGhpc1ZlcnNpb25MaXN0ID0gW107XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAobGVmdC5sZW5ndGggPiAwICYmIHJpZ2h0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnRbMF0uaXNJZ25vcmVVcGRhdGUgPT0gdHJ1ZSAmJiBsZWZ0WzBdLm9sZFZlcnNpb24gIT0gbGVmdFswXS52ZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVVcGRhdGVMaXN0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyaWdodFswXS5pc0lnbm9yZVVwZGF0ZSA9PSB0cnVlICYmIHJpZ2h0WzBdLm9sZFZlcnNpb24gIT0gcmlnaHRbMF0udmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWdub3JlVXBkYXRlTGlzdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxlZnRbMF0ub2xkVmVyc2lvbiA8IGxlZnRbMF0udmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyaWdodFswXS5vbGRWZXJzaW9uIDwgcmlnaHRbMF0udmVyc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocmlnaHQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGVmdFswXS5vbGRWZXJzaW9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmlnaHRbMF0ub2xkVmVyc2lvbiA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzVGhpc1ZlcnNpb25MaXN0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzVGhpc1ZlcnNpb25MaXN0LnB1c2gocmlnaHQuc2hpZnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoaWdub3JlVXBkYXRlTGlzdC5sZW5ndGgpIHJlc3VsdC5wdXNoKGlnbm9yZVVwZGF0ZUxpc3Quc2hpZnQoKSk7XG5cbiAgICAgICAgICAgICAgICB3aGlsZSAoaXNUaGlzVmVyc2lvbkxpc3QubGVuZ3RoKSByZXN1bHQucHVzaChpc1RoaXNWZXJzaW9uTGlzdC5zaGlmdCgpKTtcblxuICAgICAgICAgICAgICAgIHdoaWxlIChsZWZ0Lmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcblxuICAgICAgICAgICAgICAgIHdoaWxlIChyaWdodC5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVtb3RlUnVsZXMgPSBtZXJnZVNvcnQocmVtb3RlUnVsZXMpO1xuXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3Mubm9SdWxlc051bSAhPSB0cnVlICYmIHNldHRpbmdzLmhpZGVBbGwgIT0gdHJ1ZSlcbiAgICAgICAgICAgICAgICBkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCI8Yj7or6Xku5PlupPlhbHmnIkg4oCY4oCYXCIgKyByZW1vdGVSdWxlcy5sZW5ndGggKyBcIuKAmeKAmSDmnaHop4TliJk8Yi8+XCIsXG4gICAgICAgICAgICAgICAgICAgIGNvbF90eXBlOiBcInRleHRfMVwiXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIHNldEVycm9yKEpTT04uc3RyaW5naWZ5KHJlbW90ZVJ1bGVzKSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbW90ZVJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGogPSByZW1vdGVSdWxlc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgcnVsZVdpdGhNYXBwaW5nID0gZ2V0UnVsZUluUnVsZXNXaXRoTWFwcGluZyhyZW1vdGVSdWxlcywgaik7XG4gICAgICAgICAgICAgICAgaWYgKHJ1bGVXaXRoTWFwcGluZyAhPSBudWxsICYmIGdldFJ1bGVJblJ1bGVzV2l0aE1hcHBpbmcobXlSdWxlcywgaikpIGogPSBydWxlV2l0aE1hcHBpbmc7XG4gICAgICAgICAgICAgICAgdmFyIHIgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MubmVlZENoYW5nZVNob3dUeXBlID09IHRydWUgJiYgai5vbGRWZXJzaW9uICE9IG51bGwgJiYgai5vbGRWZXJzaW9uID49IGoudmVyc2lvbiAmJiByZW1vdGVSdWxlcy5sZW5ndGggPiBzZXR0aW5ncy5zaG93RnVsbFRleHRNYXgpIHIuY29sX3R5cGUgPSBzZXR0aW5ncy5vdmVyTWF4U2hvd1R5cGU7XG4gICAgICAgICAgICAgICAgci5kZXNjID0gKHNldHRpbmdzLm5vSWdub3JlVXBkYXRlICE9IHRydWUgJiYgai5pc0lnbm9yZVVwZGF0ZSA9PSB0cnVlKSAmJiAoai5vbGRWZXJzaW9uID09IG51bGwgfHwgai5vbGRWZXJzaW9uIDwgai52ZXJzaW9uKSA/IFwi6K+l6KeE5YiZ5bey5b+955Wl5pys5qyh5pu05pawXCIgOiBkZXNjKG15UnVsZXMsIGopO1xuICAgICAgICAgICAgICAgIHIudGl0bGUgPSBqLm1hcHBpbmdUaXRsZSAhPSBudWxsICYmIGoubWFwcGluZ1RpdGxlICE9IFwiXCIgJiYgai5pc01hcHBlZCA9PSB0cnVlID8gai5tYXBwaW5nVGl0bGUgOiBqLnRpdGxlO1xuICAgICAgICAgICAgICAgIHIudXJsID0gaXNJbkFycmF5KG15UnVsZXMsIGopIHx8IGouaXNNYXBwZWQgPT0gdHJ1ZSA/IChqLm9sZFZlcnNpb24gIT0gbnVsbCAmJiBqLm9sZFZlcnNpb24gPCBqLnZlcnNpb24gPyAoai5ydWxlIHx8IFwiXCIpIDogKFwiaGlrZXI6Ly9ob21lQFwiICsgKGoubG9jYWxUaXRsZSAhPSBudWxsICYmIGoubG9jYWxUaXRsZSAhPSBcIlwiID8gai5sb2NhbFRpdGxlIDogai50aXRsZSkpKSA6IChqLnJ1bGUgfHwgXCJcIik7XG4gICAgICAgICAgICAgICAgLy9yLmNvbnRlbnQgPSBqLnVwZGF0ZVRleHQ7XG4gICAgICAgICAgICAgICAgZC5wdXNoKHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG59XG5yZXMuZGF0YSA9IGQ7XG5zZXRIb21lUmVzdWx0KHJlcyk7Iiwic2RldGFpbF9jb2xfdHlwZSI6Im1vdmllXzEiLCJzZGV0YWlsX2ZpbmRfcnVsZSI6IiJ9" 
}